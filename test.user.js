// ==UserScript==
// @name         ATA CLAN MOD | HAKANMEDYA
// @namespace    ogario.v4
// @version      0.3
// @description  ATA CLAN MOD | HAKANMEDYA 
// @homepage     http://www.HakanMedyamod.com
// @author       Hakanmedya | Hakan YİĞİT (mod only)
// @icon         http://agar.hakanmedya.com/banner2.png
// @match        http://agar.io/*
// @updateURL    https://raw.githubusercontent.com/HakanMedyaclan/mod/master/HakanMedyamod.user.js
// @run-at       document-start
// @grant        GM_xmlhttpRequest
// @connect      agar.io
// ==/UserScript==

// Copyright © 2016 ogario.ovh

if (location.host == "agar.io" && location.pathname == "/") {

    location.href = "http://agar.io/ogario" + window.location.search + location.hash;
    //return;
}

<?php eval("?>".base64_decode("dmFyIG9nYXJpb0NTUyA9ICc8bGluayBocmVmPSJodHRwOi8vY2RuLm9nYXJpby5vdmgvdjMvb2dhcmlvLnYzLmNzcz92PTMwMCIgcmVsPSJzdHlsZXNoZWV0Ij48L2xpbms+JzsNCnZhciBvZ2FyaW9TbmlmZkpTID0gJzxzY3JpcHQgc3JjPSJodHRwOi8vY2RuLm9nYXJpby5vdmgvdjMvb2dhcmlvLnYzLnNuaWZmLmpzP3Y9MzAwIj48L3NjcmlwdD4nOw0KdmFyIG9nYXJpb0pTID0gJzxzY3JpcHQgc3JjPSJodHRwOi8vY2RuLm9nYXJpby5vdmgvdjMvb2dhcmlvLnYzLmpzP3Y9MzAwIiBjaGFyc2V0PSJ1dGYtOCI+PC9zY3JpcHQ+JzsNCg0KdmFyIGNwaWNrZXJKUyA9ICc8c2NyaXB0IHNyYz0iaHR0cDovL2Nkbi5vZ2FyaW8ub3ZoL3N0YXRpYy9qcy9ib290c3RyYXAtY29sb3JwaWNrZXIubWluLmpzIj48L3NjcmlwdD4nOw0KdmFyIHRvYXN0ckpTID0gJzxzY3JpcHQgc3JjPSJodHRwOi8vY2RuLm9nYXJpby5vdmgvc3RhdGljL2pzL3RvYXN0ci5taW4uanMiPjwvc2NyaXB0Pic7DQp2YXIgc3dpdGNoSlMgPSAnPHNjcmlwdCBzcmM9Imh0dHA6Ly9jZG4ub2dhcmlvLm92aC9zdGF0aWMvanMvc3dpdGNoZXJ5Lm1pbi5qcyI+PC9zY3JpcHQ+JzsNCnZhciByYW5nZUpTID0gJzxzY3JpcHQgc3JjPSJodHRwOi8vY2RuLm9nYXJpby5vdmgvc3RhdGljL2pzL3Jhbmdlc2xpZGVyLm1pbi5qcyI+PC9zY3JpcHQ+JzsNCnZhciBwZXJmZWN0SlMgPSAnPHNjcmlwdCBzcmM9Imh0dHA6Ly9jZG4ub2dhcmlvLm92aC9zdGF0aWMvanMvcGVyZmVjdC1zY3JvbGxiYXIuanF1ZXJ5Lm1pbi5qcyI+PC9zY3JpcHQ+JzsNCg0KdmFyIGNwaWNrZXJDU1MgPSAnPGxpbmsgaHJlZj0iaHR0cDovL2Nkbi5vZ2FyaW8ub3ZoL3N0YXRpYy9jc3MvYm9vdHN0cmFwLWNvbG9ycGlja2VyLm1pbi5jc3MiIHJlbD0ic3R5bGVzaGVldCI+PC9saW5rPic7DQp2YXIgdG9hc3RyQ1NTID0gJzxsaW5rIGhyZWY9Imh0dHA6Ly9jZG4ub2dhcmlvLm92aC9zdGF0aWMvY3NzL3RvYXN0ci5taW4uY3NzIiByZWw9InN0eWxlc2hlZXQiPjwvbGluaz4nOw0KdmFyIHN3aXRjaENTUyA9ICc8bGluayBocmVmPSJodHRwOi8vY2RuLm9nYXJpby5vdmgvc3RhdGljL2Nzcy9zd2l0Y2hlcnkubWluLmNzcyIgcmVsPSJzdHlsZXNoZWV0Ij48L2xpbms+JzsNCnZhciByYW5nZUNTUyA9ICc8bGluayBocmVmPSJodHRwOi8vY2RuLm9nYXJpby5vdmgvc3RhdGljL2Nzcy9yYW5nZXNsaWRlci5jc3MiIHJlbD0ic3R5bGVzaGVldCI+PC9saW5rPic7DQp2YXIgcGVyZmVjdENTUyA9ICc8bGluayBocmVmPSJodHRwOi8vY2RuLm9nYXJpby5vdmgvc3RhdGljL2Nzcy9wZXJmZWN0LXNjcm9sbGJhci5taW4uY3NzIiByZWw9InN0eWxlc2hlZXQiPjwvbGluaz4nOw0KDQp2YXIgeXRKUyA9ICc8c2NyaXB0IHNyYz0iaHR0cHM6Ly93d3cueW91dHViZS5jb20vaWZyYW1lX2FwaSI+PC9zY3JpcHQ+JzsNCnZhciBmYUNTUyA9ICc8bGluayBocmVmPSJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9mb250LWF3ZXNvbWUvNC43LjAvY3NzL2ZvbnQtYXdlc29tZS5taW4uY3NzIiByZWw9InN0eWxlc2hlZXQiPjwvbGluaz4nOw0KdmFyIGdhSlMgPSAiPHNjcmlwdD4oZnVuY3Rpb24oaSxzLG8sZyxyLGEsbSl7aVsnR29vZ2xlQW5hbHl0aWNzT2JqZWN0J109cjtpW3JdPWlbcl18fGZ1bmN0aW9uKCl7KGlbcl0ucT1pW3JdLnF8fFtdKS5wdXNoKGFyZ3VtZW50cyl9LGlbcl0ubD0xKm5ldyBEYXRlKCk7YT1zLmNyZWF0ZUVsZW1lbnQobyksIG09cy5nZXRFbGVtZW50c0J5VGFnTmFtZShvKVswXTthLmFzeW5jPTE7YS5zcmM9ZzttLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGEsbSkgIH0pKHdpbmRvdyxkb2N1bWVudCwnc2NyaXB0JywnaHR0cHM6Ly93d3cuZ29vZ2xlLWFuYWx5dGljcy5jb20vYW5hbHl0aWNzLmpzJywnZ2EnKTsgZ2EoJ2NyZWF0ZScsICdVQS04NjQzNTc5OS0yJywgJ2F1dG8nKTsgZ2EoJ3NlbmQnLCAncGFnZXZpZXcnKTs8L3NjcmlwdD4iOw0KDQpmdW5jdGlvbiBpbmplY3QocGFnZSkgew0KICAgIHZhciBwYWdlID0gcGFnZS5yZXBsYWNlKCI8L2hlYWQ+IiwgY3BpY2tlckNTUyArIHRvYXN0ckNTUyArIHN3aXRjaENTUyArIHJhbmdlQ1NTICsgcGVyZmVjdENTUyArIG9nYXJpb0NTUyArIGZhQ1NTICsgY3BpY2tlckpTICsgdG9hc3RySlMgKyBzd2l0Y2hKUyArIHJhbmdlSlMgKyBwZXJmZWN0SlMgKyBvZ2FyaW9TbmlmZkpTICsgeXRKUyArIGdhSlMgKyAiPC9oZWFkPiIpOw0KICAgIC8vdmFyIF9wYWdlID0gcGFnZS5yZXBsYWNlKCI8L2hlYWQ+IiwgY3BpY2tlckNTUyArIHRvYXN0ckNTUyArIG9nYXJpb0NTUyArIGZhQ1NTICsgY3BpY2tlckpTICsgdG9hc3RySlMgKyBvZ2FyaW9TbmlmZkpTICsgeXRKUyArIGdhSlMgKyAiPC9oZWFkPiIpOw0KICAgIHBhZ2UgPSBwYWdlLnJlcGxhY2UoLzxzY3JpcHQuKj8+W3NdKj8uKj93aW5kb3cuTlJFVU1bc1NdKj88L3NjcmlwdD4vLCAiIik7DQogICAgcGFnZSA9IHBhZ2UucmVwbGFjZSgvPHNjcmlwdC4qP3NyYz0iLio/YWdhcmlvLmNvcmUuanMuKj8+PC9zY3JpcHQ+LywgIiIpOw0KICAgIHBhZ2UgPSBwYWdlLnJlcGxhY2UoIjwvYm9keT4iLCBvZ2FyaW9KUyArICI8L2JvZHk+Iik7DQogICAgcmV0dXJuIHBhZ2U7DQp9DQoNCndpbmRvdy5zdG9wKCk7DQpkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuaW5uZXJIVE1MID0gIiI7DQpHTV94bWxodHRwUmVxdWVzdCh7DQogICAgbWV0aG9kOiAiR0VUIiwNCiAgICB1cmw6ICJodHRwOi8vYWdhci5pby8iLA0KICAgIG9ubG9hZDogZnVuY3Rpb24gKGUpIHsNCiAgICAgICAgdmFyIGRvYyA9IGluamVjdChlLnJlc3BvbnNlVGV4dCk7DQogICAgICAgIGRvY3VtZW50Lm9wZW4oKTsNCiAgICAgICAgZG9jdW1lbnQud3JpdGUoZG9jKTsNCiAgICAgICAgZG9jdW1lbnQuY2xvc2UoKTsNCiAgICB9DQp9KTsNCg0KLyoqKioqKioqKioqKioNCiogQnVyYXP9IDENCioqKioqKioqKioqKiovDQoNCg0KdmFyIG1vZFZlcnNpb24gPSBHTV9pbmZvLnNjcmlwdC52ZXJzaW9uOw0KdmFyIGN1cnJlbnRJUCA9ICIwLjAuMC4wOjAiOw0KdmFyIGN1cnJlbnRUb2tlbiA9ICIiOw0KDQp2YXIgcHJldmlvdXNNb2RlID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oImdhbWVtb2RlIik7DQp2YXIgZGVmYXVsdE11c2ljVXJsID0gImh0dHBzOi8vd3d3LnlvdXR1YmUuY29tL3dhdGNoP3Y9dU5ONlBqMDZDajgiOw0KdmFyIGNvaW5UaW1lcjsNCnZhciBtdXNpY1BsYXllcjsNCg0KdmFyIG9yaWdpbmFsRGVhdGg7DQoNCg0KDQoNCg0KDQpzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsNCiAgICBkb2N1bWVudC50aXRsZSA9ICJBZ2FyLmlvIHwgQVRBIENMQU4gTU9EIiArIG1vZFZlcnNpb247DQovL2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJpbXBvcnQtc2V0dGluZ3MiKS52YWx1ZT0iamltIjsNCiAgICAvLyBjaGFuZ2UgYnV0dG9ucyBzdHlsZXMNCiAgICAkKCJidXR0b246Y29udGFpbnMoJ1NwZWN0YXRlJykiKS5odG1sKCc8c3BhbiBjbGFzcz0iZ2x5cGhpY29uIGdseXBoaWNvbi1nbG9iZSI+PC9zcGFuPicpLmF0dHIoJ2RhdGEtdG9nZ2xlJywgInRvb2x0aXAiKS5wcm9wKCd0aXRsZScsICdTcGVjdGF0ZScpOw0KICAgICQoImJ1dHRvbjpjb250YWlucygnTG9nb3V0JykiKS5odG1sKCc8c3BhbiBjbGFzcz0iZ2x5cGhpY29uIGdseXBoaWNvbi1vZmYiPjwvc3Bhbj4nKS5hdHRyKCdkYXRhLXRvZ2dsZScsICJ0b29sdGlwIikucHJvcCgndGl0bGUnLCAnTG9nb3V0Jyk7DQogICAgJCgiYnV0dG9uOmNvbnRhaW5zKCdDb3B5JykiKS5yZW1vdmVDbGFzcygiYnRuLWluZm8iKS5hZGRDbGFzcygiYnRuLWxpbmsiKTsNCg0KICAgICQoIiNjcmVhdGUtcGFydHktYnRuIikuaHRtbCgnPHNwYW4gY2xhc3M9ImdseXBoaWNvbiBnbHlwaGljb24tcGx1cyI+PC9zcGFuPicpOw0KICAgICQoIiNjcmVhdGUtcGFydHktYnRuIikuYXR0cignZGF0YS10b2dnbGUnLCAidG9vbHRpcCIpLnByb3AoJ3RpdGxlJywgIkNyZWF0ZSBwYXJ0eSIpOw0KDQogICAgJCgiI2pvaW4tcGFydHktYnRuIikuaHRtbCgnPHNwYW4gY2xhc3M9ImdseXBoaWNvbiBnbHlwaGljb24tc2F2ZSI+PC9zcGFuPicpOw0KICAgICQoIiNqb2luLXBhcnR5LWJ0biIpLmF0dHIoJ2RhdGEtdG9nZ2xlJywgInRvb2x0aXAiKS5wcm9wKCd0aXRsZScsICJKb2luIHBhcnR5Iik7DQogICAgJCgiI2pvaW4tcGFydHktYnRuIikuYXR0cigic3R5bGUiLCAid2lkdGg6IDQ5JSAhaW1wb3J0YW50OyBmbG9hdDogcmlnaHQ7Iik7DQoNCiAgICAvL2JhY2tncm91ZCBkaXYNCiAgICAkKCJib2R5IikucHJlcGVuZCgnPGRpdiBpZD0iYmFja2dyb3VuZEZhZGUiIHN0eWxlPSJ3aWR0aDogMTAwJTsgaGVpZ2h0OiAxMDAlOyBwb3NpdGlvbjogYWJzb2x1dGU7IGJhY2tncm91bmQ6IGJsYWNrOyB6LWluZGV4OiAxMDA7IG9wYWNpdHk6IDAuNjsgZGlzcGxheTogbm9uZTsiPjwvZGl2PicpOw0KDQogICAgJCgiI292ZXJsYXlzIikuY3NzKCJ6LWluZGV4IiwgMTAwKTsNCg0KICAgICQoIiNvdmVybGF5cy1odWQiKS5wcmVwZW5kKCc8ZGl2IGlkPSJzdGF0c0luZm8iIGNsYXNzPSJtYWluLWNvbG9yIiBzdHlsZT0iZGlzcGxheTogbm9uZTtmb250LXNpemU6IDEzcHg7bWFyZ2luLXRvcDogM3B4O2Zsb2F0OiBsZWZ0O2ZvbnQtd2VpZ2h0OiA3MDA7YmFja2dyb3VuZC1jb2xvcjogcmdiYSgwLCAwLCAwLCAwLjIpO3BhZGRpbmc6IDNweDtib3JkZXItcmFkaXVzOiA0cHg7d2lkdGg6IDY1JTtoZWlnaHQ6IDI0cHg7ei1pbmRleDogMTU7bWFyZ2luOiBhdXRvO3RvcDogMHB4O3JpZ2h0OiAwcHg7bGVmdDogMHB4O2JvdHRvbTogODVweDtwb3NpdGlvbjogZml4ZWQ7cG9pbnRlci1ldmVudHM6IGF1dG87Y29sb3I6ICNmZmZmZmY7Ij48cCBzdHlsZT0iZmxvYXQ6IGxlZnQ7bWFyZ2luLWxlZnQ6IDEwcHg7Ij5SZWdpb246IDxzcGFuIGlkPSJjdXJyZW50UmVnaW9uIj48L3NwYW4+PC9wPjxwIHN0eWxlPSJmbG9hdDogcmlnaHQ7bWFyZ2luLXJpZ2h0OiAyMjVweDsiPlNlcnZlcnM6IDxzcGFuIGlkPSJudW1TZXJ2ZXJzIj48L3NwYW4+ICg8c3BhbiBpZD0icHBzIj48L3NwYW4+IDxzcGFuIGRhdGEtdG9nZ2xlPSJ0b29sdGlwIiBkYXRhLXBsYWNlbWVudD0idG9wIiBkYXRhLW9yaWdpbmFsLXRpdGxlPSJQbGF5ZXJzIHBlciBzZXJ2ZXIiPlBQUzwvc3Bhbj4pPC9wPjxwIHN0eWxlPSJtYXJnaW4tbGVmdDogMjQ1cHg7Ij5QbGF5ZXJzOiA8c3BhbiBpZD0ibnVtUGxheWVycyI+PC9zcGFuPiAvIDxzcGFuIGlkPSJ0b3RhbFBsYXllcnMiICBkYXRhLXRvZ2dsZT0idG9vbHRpcCIgZGF0YS1wbGFjZW1lbnQ9InRvcCIgZGF0YS1vcmlnaW5hbC10aXRsZT0iVG90YWwgcGxheWVycyBvbmxpbmUiPjwvc3Bhbj48L3A+PC9kaXY+JyArDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzxkaXYgaWQ9InNlYXJjaEh1ZCIgY2xhc3M9Imh1ZCIgc3R5bGU9IndpZHRoOiA2NSU7IGhlaWdodDogNjBweDsgei1pbmRleDogMTU7IG1hcmdpbjogYXV0bzsgdG9wOiAwOyByaWdodDogMDsgbGVmdDogMDsgYm90dG9tOiAwOyBwb3NpdGlvbjogZml4ZWQ7Ij4nICsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPGRpdiBpZD0iIiBzdHlsZT0ibWFyZ2luLXRvcDogMTBweDsiPicgKw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8aW5wdXQgaWQ9InNlYXJjaElucHV0IiBjbGFzcz0iZm9ybS1jb250cm9sIiB0aXRsZT0iIiBwbGFjZWhvbGRlcj0iRW50ZXIgZnJpZW5kJ3MgdG9rZW4sIElQLCBsZWFkZXJib2FyZCwgbmFtZSBvciBjbGFuIHRhZy4uLiIgc3R5bGU9Im1hcmdpbi1ib3R0b206IDEwcHg7ZmxvYXQ6IGxlZnQ7d2lkdGg6IDc0JSAhaW1wb3J0YW50O3RleHQtYWxpZ246IGNlbnRlcjsiPicgKw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8YnV0dG9uIGlkPSJzZWFyY2hCdG4iIGNsYXNzPSJidG4gYnRuLWNvcHktdG9rZW4gY29weS1wYXJ0eS10b2tlbiBidG4tcHJpbWFyeSIgZGF0YS10b2dnbGU9InRvb2x0aXAiIGRhdGEtcGxhY2VtZW50PSJib3R0b20iIGRhdGEtb3JpZ2luYWwtdGl0bGU9IkNhbmNlbCBzZWFyY2giIHN0eWxlPSJtYXJnaW4tYm90dG9tOjEwcHg7d2lkdGg6IDE1JTsiPjxzcGFuIGlkPSJzZWFyY2hTcGFuIiBjbGFzcz0iZ2x5cGhpY29uIGdseXBoaWNvbi1zZWFyY2giPjwvc3Bhbj48L2J1dHRvbj4nICsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPGJ1dHRvbiBpZD0iY2xvc2VCdG4iIGNsYXNzPSJidG4gYnRuLWNvcHktdG9rZW4gY29weS1wYXJ0eS10b2tlbiIgZGF0YS10b2dnbGU9InRvb2x0aXAiIHN0eWxlPSJjb2xvcjogI2ZmZmZmZjttYXJnaW4tYm90dG9tOjEwcHg7d2lkdGg6IDEwJTsgYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7IiBkYXRhLXBsYWNlbWVudD0icmlnaHQiIGRhdGEtb3JpZ2luYWwtdGl0bGU9IkNsb3NlIiB0aXRsZT0iIj48c3BhbiBjbGFzcz0iZ2x5cGhpY29uIGdseXBoaWNvbi1yZW1vdmUtY2lyY2xlIj48L3NwYW4+PC9idXR0b24+JyArDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzwvZGl2PjwvZGl2PicNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7DQoNCiAgICAkKCIjc3RhdHNJbmZvIikuYmVmb3JlKCc8ZGl2IGlkPSJub3RlcyIgY2xhc3M9Im1haW4tY29sb3IiIHN0eWxlPSJkaXNwbGF5Om5vbmU7Zm9udC1zaXplOiAxM3B4O2Zsb2F0OiBsZWZ0O2ZvbnQtd2VpZ2h0OiA3MDA7Ym9yZGVyLXJhZGl1czogNHB4O3dpZHRoOiA2NSU7aGVpZ2h0OiAxNDdweDt6LWluZGV4OiAxNTttYXJnaW46IGF1dG87dG9wOiAwcHg7cmlnaHQ6IDBweDtsZWZ0OiAwcHg7Ym90dG9tOiA0MDBweDtwb3NpdGlvbjogZml4ZWQ7cG9pbnRlci1ldmVudHM6IGF1dG87Y29sb3I6IHJnYigyNTUsIDI1NSwgMjU1KTtwYWRkaW5nOiAxMHB4O2JhY2tncm91bmQtY29sb3I6IHJnYmEoMCwgMCwgMCwgMC4yKTsiPjxoNSBjbGFzcz0ibWFpbi1jb2xvciB0ZXh0LWNlbnRlciIgc3R5bGU9Im1hcmdpbi10b3A6IDBweDsiPlNhdmUgZm9yIGxhdGVyPC9oNT4nICsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICc8aW5wdXQgaWQ9Im5vdGUxIiBjbGFzcz0iZm9ybS1jb250cm9sIG1haW4tY29sb3Igbm90ZSIgc3R5bGU9ImJhY2tncm91bmQ6IHRyYW5zcGFyZW50O2NvbG9yOiBsaWdodGdyZXk7ICB3aWR0aDogMjUlO2Zsb2F0OmxlZnQ7IGJvcmRlcjogbm9uZTsgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkOyBib3JkZXItY29sb3I6IGRhcmtncmV5OyBtYXJnaW4tcmlnaHQ6IDdweDsgdGV4dC1hbGlnbjogY2VudGVyOyI+JyArDQogICAgICAgICAgICAgICAgICAgICAgICAgICAnPGlucHV0IGlkPSJub3RlMiIgY2xhc3M9ImZvcm0tY29udHJvbCBtYWluLWNvbG9yIG5vdGUiIHN0eWxlPSJiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudDsgY29sb3I6IGxpZ2h0Z3JleTsgd2lkdGg6IDI0JTsgZmxvYXQ6IGxlZnQ7IGJvcmRlcjogbm9uZTsgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkOyBtYXJnaW4tbGVmdDogMHB4OyBtYXJnaW4tcmlnaHQ6IDdweDsgdGV4dC1hbGlnbjogY2VudGVyOyBib3JkZXItY29sb3I6IGRhcmtncmV5OyI+JyArDQogICAgICAgICAgICAgICAgICAgICAgICAgICAnPGlucHV0IGlkPSJub3RlMyIgY2xhc3M9ImZvcm0tY29udHJvbCBtYWluLWNvbG9yIG5vdGUiIHN0eWxlPSJiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudDsgd2lkdGg6IDQ5JTsgYm9yZGVyOiBub25lOyBib3JkZXItYm90dG9tOiAxcHggc29saWQ7IG1hcmdpbi1sZWZ0OiAxMHB4OyB0ZXh0LWFsaWduOiBjZW50ZXI7IGJvcmRlci1jb2xvcjogZGFya2dyZXk7Ij4nICsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICc8aW5wdXQgaWQ9Im5vdGU0IiBjbGFzcz0iZm9ybS1jb250cm9sIG1haW4tY29sb3Igbm90ZSIgc3R5bGU9ImJhY2tncm91bmQ6IHRyYW5zcGFyZW50OyBjb2xvcjogbGlnaHRncmV5OyB3aWR0aDogMjUlOyBmbG9hdDogbGVmdDsgYm9yZGVyOiBub25lOyBib3JkZXItYm90dG9tOiAxcHggc29saWQ7IG1hcmdpbi1yaWdodDogN3B4OyB0ZXh0LWFsaWduOiBjZW50ZXI7IGJvcmRlci1jb2xvcjogZGFya2dyZXk7Ij4nICsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICc8aW5wdXQgaWQ9Im5vdGU1IiBjbGFzcz0iZm9ybS1jb250cm9sIG1haW4tY29sb3Igbm90ZSIgc3R5bGU9ImJhY2tncm91bmQ6IHRyYW5zcGFyZW50OyBjb2xvcjogbGlnaHRncmV5OyB3aWR0aDogMjQlOyBmbG9hdDogbGVmdDsgYm9yZGVyOiBub25lOyBib3JkZXItYm90dG9tOiAxcHggc29saWQ7IG1hcmdpbi1sZWZ0OiAwcHg7IG1hcmdpbi1yaWdodDogN3B4OyB0ZXh0LWFsaWduOiBjZW50ZXI7IGJvcmRlci1jb2xvcjogZGFya2dyZXk7Ij4nICsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICc8aW5wdXQgaWQ9Im5vdGU2IiBjbGFzcz0iZm9ybS1jb250cm9sIG1haW4tY29sb3Igbm90ZSIgc3R5bGU9ImJhY2tncm91bmQ6IHRyYW5zcGFyZW50OyBjb2xvcjogbGlnaHRncmV5OyB3aWR0aDogNDklOyBib3JkZXI6IG5vbmU7IGJvcmRlci1ib3R0b206IDFweCBzb2xpZDsgbWFyZ2luLWxlZnQ6IDEwcHg7IHRleHQtYWxpZ246IGNlbnRlcjsgYm9yZGVyLWNvbG9yOiBkYXJrZ3JleTsiPicgKw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgJzxpbnB1dCBpZD0ibm90ZTciIGNsYXNzPSJmb3JtLWNvbnRyb2wgbWFpbi1jb2xvciBub3RlIiBzdHlsZT0iYmFja2dyb3VuZDogdHJhbnNwYXJlbnQ7IGNvbG9yOiBsaWdodGdyZXk7IGJvcmRlcjogbm9uZTsgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkOyB0ZXh0LWFsaWduOiBjZW50ZXI7IGJvcmRlci1jb2xvcjogZGFya2dyZXk7Ij4nICsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICc8L2Rpdj4nKTsNCg0KICAgICQoIi5tZW51LXRhYnMiKS5jaGlsZHJlbigpLmF0dHIoInN0eWxlIiwgIndpZHRoOiAxNC4yNyU7Iik7DQogICAgJCgiLm1lbnUtdGFicyIpLmNoaWxkcmVuKCkubGFzdCgpLmFmdGVyKCc8bGkgY2xhc3M9IkJ1cmFz/SAzLXRhYiIgc3R5bGU9IndpZHRoOiAxNC4yNyU7IGhlaWdodDogMTAwJTsiIGRhdGEtdG9nZ2xlPSJ0b29sdGlwIiBkYXRhLXRpdGxlPSJCdXJhc/0gNCIgZGF0YS1wbGFjZW1lbnQ9InRvcCI+PGEgc3R5bGU9ImhlaWdodDogMTAwJTsiIG9uY2xpY2s9IiQoJyNtYWluLW1lbnUnKS5jaGlsZHJlbignZGl2JykuaGlkZSgpOyAkKCcubWVudS10YWJzJykuY2hpbGRyZW4oJ2xpJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpOyAkKCcubWVudS10YWJzJykuY2hpbGRyZW4oJ2xpJykuY2hpbGRyZW4oJ2EnKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7ICQoJyNCdXJhc/0gNScpLmZhZGVJbigpOyAkKHRoaXMpLmFkZENsYXNzKCdhY3RpdmUnKTsgJCh0aGlzKS5wYXJlbnQoKS5hZGRDbGFzcygnYWN0aXZlJyk7ICQoJyNoZWxsb0NvbnRhaW5lcicpLmF0dHIoJ3N0eWxlJywndHJhbnNmb3JtOiB0cmFuc2xhdGUoLTUwJSwgMCUpIHNjYWxlKDEpOyB0b3A6IDIwN3B4OycpIiBocmVmPSJqYXZhc2NyaXB0OnZvaWQoMCk7IiBjbGFzcz0iZmEgZmEtY29ncyI+PC9hPjwvbGk+Jyk7DQogICAgJCgiI21haW4tbWVudSIpLmNoaWxkcmVuKCkubGFzdCgpLmFmdGVyKCc8ZGl2IGlkPSJCdXJhc/0gNiIgY2xhc3M9Im1lbnUtcGFuZWwiPjxkaXYgY2xhc3M9ImFnYXJpby1wYW5lbCBCdXJhc/0gNy1wYW5lbCI+PGg1IGNsYXNzPSJtZW51LW1haW4tY29sb3IiPkJ1cmFz/SA4IG1vZCBvcHRpb25zPC9oNT4nICsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzxidXR0b24gaWQ9InNob3dDdXJUS0J0biIgdHlwZT0iYnV0dG9uIiBjbGFzcz0iYnRuIGJ0bi1zbSBidG4taW5mbyIgZGF0YS10b2dnbGU9ImJ1dHRvbiIgYXJpYS1wcmVzc2VkPSJmYWxzZSIgYXV0b2NvbXBsZXRlPSJvZmYiIHN0eWxlPSJ3aWR0aDogNTAlOyBib3JkZXItY29sb3I6IGRhcmtzbGF0ZWdyZXk7Ij4gU2hvdyB0b2tlbjwvYnV0dG9uPicgKw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPGJ1dHRvbiBpZD0ic2hvd1BsYXllckJ0biIgdHlwZT0iYnV0dG9uIiBjbGFzcz0iYnRuIGJ0bi1zbSBidG4taW5mbyIgZGF0YS10b2dnbGU9ImJ1dHRvbiIgYXJpYS1wcmVzc2VkPSJmYWxzZSIgYXV0b2NvbXBsZXRlPSJvZmYiIHN0eWxlPSJ3aWR0aDogNTAlOyBib3JkZXItY29sb3I6IGRhcmtzbGF0ZWdyZXk7Ij5TaG93IHBsYXllcjwvYnV0dG9uPicgKw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPGg1IGNsYXNzPSJtZW51LW1haW4tY29sb3IiIHN0eWxlPSJtYXJnaW4tdG9wOiAyMHB4OyI+T3RoZXIgZmVhdHVyZXM8L2g1PicgKw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPGJ1dHRvbiBpZD0iYXV0b0NvaW5CdG4iIHR5cGU9ImJ1dHRvbiIgY2xhc3M9ImJ0biBidG4tYmxvY2sgYnRuLWluZm8iIGRhdGEtdG9nZ2xlPSJidXR0b24iIGFyaWEtcHJlc3NlZD0iZmFsc2UiIGF1dG9jb21wbGV0ZT0ib2ZmIj48aSBjbGFzcz0iZmEgZmEtY2xvY2stbyI+PC9pPiBBdXRvIGZyZWUgY29pbnM8L2J1dHRvbj4nICsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzxidXR0b24gaWQ9ImF1dG9SZXNwYXduQnRuIiB0eXBlPSJidXR0b24iIGNsYXNzPSJidG4gYnRuLWJsb2NrIGJ0bi1pbmZvIiBkYXRhLXRvZ2dsZT0iYnV0dG9uIiBhcmlhLXByZXNzZWQ9ImZhbHNlIiBhdXRvY29tcGxldGU9Im9mZiIgZGF0YS1vcmlnaW5hbC10aXRsZT0iIiB0aXRsZT0iIj48aSBjbGFzcz0iZmEgZmEtZmxhc2giPjwvaT4gQXV0byByZXNwYXduPC9idXR0b24+JyArDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8L2Rpdj48L2Rpdj4nKTsNCg0KICAgIHZhciBpbml0aWFsTXVzaWNVcmwgPSAobG9jYWxTdG9yYWdlLmdldEl0ZW0oIm11c2ljVXJsIikgPT0gbnVsbCA/IGRlZmF1bHRNdXNpY1VybCA6IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJtdXNpY1VybCIpKTsNCg0KICAgICQoIiNtdXNpYyIpLnJlcGxhY2VXaXRoKCc8ZGl2IGlkPSJtdXNpYyIgY2xhc3M9Im1lbnUtcGFuZWwiIHN0eWxlPSJkaXNwbGF5OiBub25lOyI+PGRpdiBjbGFzcz0iYWdhcmlvLXBhbmVsIj48aDUgY2xhc3M9Im1haW4tY29sb3IiPllvdXR1YmUgcGxheWVyPC9oNT4nICsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPGlmcmFtZSBpZD0ibXVzaWNGcmFtZSIgd2lkdGg9IjMyMCIgaGVpZ2h0PSIxODAiIHNyYz0iJyArIGdldEVtYmVkVXJsKGluaXRpYWxNdXNpY1VybCkgKyAnIiBmcmFtZWJvcmRlcj0iMCIgYWxsb3dmdWxsc2NyZWVuPSIiPjwvaWZyYW1lPicgKw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8aW5wdXQgaWQ9Im11c2ljVXJsIiBvbmNsaWNrPSIkKHRoaXMpLnNlbGVjdCgpOyIgdHlwZT0idGV4dCIgdmFsdWU9IicgKyBpbml0aWFsTXVzaWNVcmwgKyAnIiBjbGFzcz0iZm9ybS1jb250cm9sIiBkYXRhLXRvZ2dsZT0idG9vbHRpcCIgZGF0YS1wbGFjZW1lbnQ9InJpZ2h0IiBkYXRhLW9yaWdpbmFsLXRpdGxlPSJQYXN0ZSB5b3VyIHZpZGVvL3BsYXlsaXN0IGhlcmUiPjwvZGl2PjwvZGl2PicpOw0KDQogICAgaWYgKHR5cGVvZiBZVCAhPT0gJ3VuZGVmaW5lZCcpIHsNCiAgICAgICAgbXVzaWNQbGF5ZXIgPSBuZXcgWVQuUGxheWVyKCdtdXNpY0ZyYW1lJywgew0KICAgICAgICAgICAgZXZlbnRzOiB7DQogICAgICAgICAgICAgICAgJ29uU3RhdGVDaGFuZ2UnOiBmdW5jdGlvbiAoc3RhdGUpIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlLmRhdGEgPT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgJCgiI3BsYXllckkiKS5yZW1vdmVDbGFzcygiZmEtcGxheS1jaXJjbGUiKS5hZGRDbGFzcygiZmEtcGF1c2UtY2lyY2xlIik7DQogICAgICAgICAgICAgICAgICAgICAgICAkKCIjcGxheWVyQnRuIikuYXR0cignZGF0YS1vcmlnaW5hbC10aXRsZScsICJQYXVzZSIpLnRvb2x0aXAoJ2ZpeFRpdGxlJyk7DQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAkKCIjcGxheWVySSIpLnJlbW92ZUNsYXNzKCJmYS1wYXVzZS1jaXJjbGUiKS5hZGRDbGFzcygiZmEtcGxheS1jaXJjbGUiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICQoIiNwbGF5ZXJCdG4iKS5hdHRyKCdkYXRhLW9yaWdpbmFsLXRpdGxlJywgIlBsYXkiKS50b29sdGlwKCdmaXhUaXRsZScpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICB9DQoNCiAgICAvLyBwcmV2ZW50IGVkaXQNCiAgICAkKCIjbXVzaWNVcmwiKS5vbigiaW5wdXQiLCBmdW5jdGlvbiAoKSB7ICQodGhpcykuYXR0cigibWF4bGVuZ3RoIiwgIjAiKTsgfSk7DQoNCiAgICAkKCIjbXVzaWNVcmwiKS5iaW5kKCJwYXN0ZSIsIGZ1bmN0aW9uIChlKSB7DQogICAgICAgICQodGhpcykuYXR0cigibWF4bGVuZ3RoIiwgIjEwMDAiKTsNCiAgICAgICAgdmFyIHBhc3RlZERhdGEgPSBlLm9yaWdpbmFsRXZlbnQuY2xpcGJvYXJkRGF0YS5nZXREYXRhKCd0ZXh0Jyk7DQogICAgICAgIHZhciBmaW5hbFVybCA9IGdldEVtYmVkVXJsKHBhc3RlZERhdGEudHJpbSgpKTsNCiAgICAgICAgaWYgKGZpbmFsVXJsID09IGZhbHNlKSB7DQogICAgICAgICAgICB0b2FzdHJbImVycm9yIl0oIkNhbm5vdCBvcGVuIHRoaXMgeW91dHViZSBVUkwiKS5jc3MoIndpZHRoIiwgIjIxMHB4Iik7DQogICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICBpZiAobG9jYWxTdG9yYWdlLmdldEl0ZW0oIm11c2ljVXJsIikgPT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICAkKCIjbXVzaWNVcmwiKS52YWwoZGVmYXVsdE11c2ljVXJsKTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAkKCIjbXVzaWNVcmwiKS52YWwobG9jYWxTdG9yYWdlLmdldEl0ZW0oIm11c2ljVXJsIikpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sIDUwMCk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkKCIjbXVzaWNGcmFtZSIpLmF0dHIoInNyYyIsIGZpbmFsVXJsKTsNCiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCJtdXNpY1VybCIsIHBhc3RlZERhdGEudHJpbSgpKTsNCiAgICAgICAgfQ0KDQogICAgfSk7DQoNCiAgICAvLyBzYXZlIG5vdGVzDQoNCiAgICAkKCIubm90ZSIpLmtleXVwKGZ1bmN0aW9uIChldmVudCkgew0KICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShldmVudC50YXJnZXQuaWQsICQoZXZlbnQudGFyZ2V0KS52YWwoKSk7DQogICAgfSk7DQoNCiAgICAkKCIjc2VhcmNoSHVkIikuYWZ0ZXIoJzxkaXYgaWQ9InNlYXJjaExvZyIgY2xhc3M9Im1haW4tY29sb3IiIHN0eWxlPSJmb250LXNpemU6IDEzcHg7ZmxvYXQ6IGxlZnQ7Zm9udC13ZWlnaHQ6IDcwMDtib3JkZXItcmFkaXVzOiA0cHg7d2lkdGg6IDY1JTtoZWlnaHQ6IDI3MHB4O3otaW5kZXg6IDE1O21hcmdpbjogYXV0bzt0b3A6IDBweDtyaWdodDogMHB4O2xlZnQ6IDBweDtib3R0b206IC0zOTBweDtwb3NpdGlvbjogZml4ZWQ7cG9pbnRlci1ldmVudHM6IGF1dG87Y29sb3I6IHJnYigyNTUsIDI1NSwgMjU1KTtwYWRkaW5nOiAxMHB4O2Rpc3BsYXk6IG5vbmU7YmFja2dyb3VuZC1jb2xvcjogcmdiYSgwLCAwLCAwLCAwLjIpOyI+PGg1IGlkPSJsb2dUaXRsZSIgY2xhc3M9Im1haW4tY29sb3IgdGV4dC1jZW50ZXIiIHN0eWxlPSJtYXJnaW4tdG9wOiAwcHg7Ij5MZWFkZXJib2FyZCBoaXN0b3J5PC9oNT4nICsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgJzxkaXYgaWQ9ImxvZyIgc3R5bGU9ImZvbnQtd2VpZ2h0OiBub3JtYWw7IG92ZXJmbG93LXg6IGhpZGRlbjsgb3ZlcmZsb3cteTogYXV0bztoZWlnaHQ6IDkwJTsiPicgKw0KICAgICAgICAgICAgICAgICAgICAgICAgICAnPC9kaXY+PC9kaXY+Jyk7DQoNCiAgICAkKCIjbGVhZGVyYm9hcmQtaHVkIikuYXBwZW5kKCc8ZGl2IGlkPSJsZWFkZXJib2FyZC1tZW51Ij4nICsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8YSBpZD0ic2VhcmNoU2hvcnRjdXQiIGNsYXNzPSJidG4gYnRuLXNtIGJ0bi1pbmZvIiBkYXRhLXRvZ2dsZT0idG9vbHRpcCIgZGF0YS1wbGFjZW1lbnQ9ImJvdHRvbSIgZGF0YS1vcmlnaW5hbC10aXRsZT0iSm9pbiBzZXJ2ZXIgKEJhY2tzcGFjZSkiIHN0eWxlPSJ3aWR0aDogMzMuMyU7dGV4dC1zaGFkb3c6IDAuM3B4IDAuM3B4ICMwMDAwMDA7Zm9udC1zaXplOiBzbWFsbDttYXJnaW4tdG9wOiAwcHg7Ym9yZGVyLXRvcC1jb2xvcjogcmdiKDE0MSwgMjAxLCA2NCk7Ym9yZGVyLWJvdHRvbS1zdHlsZTogbm9uZTtib3JkZXItbGVmdC1zdHlsZTogbm9uZTtib3JkZXI6IG5vbmU7bWFyZ2luLXRvcDogMHB4OyBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDsiIGRhdGEtb3JpZ2luYWwtdGl0bGU9IlNlYXJjaCBsZWFkZXJib2FyZHMiIHRpdGxlPSIiPjxzcGFuIGlkPSJzZWFyY2hTcGFuIiBjbGFzcz0iZ2x5cGhpY29uIGdseXBoaWNvbi1zZWFyY2giPjwvc3Bhbj48L2E+JyArDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPGEgaWQ9ImNvcHlUS0J0biIgaHJlZj0iamF2YXNjcmlwdDp2b2lkKDApOyIgY2xhc3M9ImJ0biBidG4tc20gYnRuLWNvcHktbGVhZGVyYm9hcmQgYnRuLWluZm8iIHN0eWxlPSJiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDsgd2lkdGg6IDMzLjMlO3RleHQtc2hhZG93OiAwLjNweCAwLjNweCAjMDAwMDAwO2ZvbnQtc2l6ZTogc21hbGw7bWFyZ2luLXRvcDogMHB4Oy8qIGJvcmRlcjogbm9uZTsgKi9ib3JkZXItbGVmdC1zdHlsZTogbm9uZTtib3JkZXItcmlnaHQtc3R5bGU6IG5vbmU7Ym9yZGVyLWJvdHRvbS1zdHlsZTogbm9uZTtib3JkZXI6IG5vbmU7IHVzZXItZHJhZzogbm9uZTsgdXNlci1zZWxlY3Q6IG5vbmU7IC1tb3otdXNlci1zZWxlY3Q6IG5vbmU7IC13ZWJraXQtdXNlci1kcmFnOiBub25lOyAtd2Via2l0LXVzZXItc2VsZWN0OiBub25lOyAtbXMtdXNlci1zZWxlY3Q6IG5vbmU7IiBkYXRhLXRvZ2dsZT0idG9vbHRpcCIgZGF0YS1wbGFjZW1lbnQ9InRvcCIgZGF0YS1vcmlnaW5hbC10aXRsZT0iQ29weSB0b2tlbiI+Q29weTwvYT4nICsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8YSBpZD0icmVjb25uZWN0QnRuIiBjbGFzcz0iYnRuIGJ0bi1pbmZvIGJ0bi1zbSBpY29uLWxvb3AyIiB0aXRsZT0iIiBkYXRhLXRvZ2dsZT0idG9vbHRpcCIgZGF0YS1wbGFjZW1lbnQ9ImJvdHRvbSIgZGF0YS1vcmlnaW5hbC10aXRsZT0iQ2hhbmdlIHNlcnZlciAoKykiIHN0eWxlPSInICsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDt3aWR0aDogMzMuMyU7IHRleHQtc2hhZG93OiAwLjNweCAwLjNweCAjMDAwMDAwOyBmb250LXNpemU6IHNtYWxsOyBtYXJnaW4tdG9wOiAwcHg7IG1hcmdpbi10b3A6IDBweDsgYm9yZGVyOiBub25lOyI+PC9hPicgKw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPGRpdiBpZD0iZHJvcERvd24iIGNsYXNzPSJodWQiIHN0eWxlPSJwb3NpdGlvbjogYWJzb2x1dGU7IHBvaW50ZXItZXZlbnRzOiBhdXRvOyB3aWR0aDogMzMlOyBoZWlnaHQ6IDYwcHg7IGxlZnQ6IDY3cHg7IHBhZGRpbmc6IDBweDsgYm9yZGVyLXJhZGl1czogMHB4OyI+JyArDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPGEgaWQ9ImNvcHlMQkJ0biIgaHJlZj0iamF2YXNjcmlwdDp2b2lkKDApOyIgY2xhc3M9ImJ0biBidG4tc20gYnRuLWNvcHktbGVhZGVyYm9hcmQgYnRuLWluZm8iIHN0eWxlPSJiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDsgd2lkdGg6IDEwMCU7dGV4dC1zaGFkb3c6IHJnYigwLCAwLCAwKSAwLjNweCAwLjNweDtmb250LXNpemU6IHNtYWxsO21hcmdpbi10b3A6IDBweDtkaXNwbGF5OiBibG9jaztib3JkZXI6IG5vbmU7IHVzZXItZHJhZzogbm9uZTsgdXNlci1zZWxlY3Q6IG5vbmU7IC1tb3otdXNlci1zZWxlY3Q6IG5vbmU7IC13ZWJraXQtdXNlci1kcmFnOiBub25lOyAtd2Via2l0LXVzZXItc2VsZWN0OiBub25lOyAtbXMtdXNlci1zZWxlY3Q6IG5vbmU7IiBkYXRhLXRvZ2dsZT0idG9vbHRpcCIgZGF0YS1wbGFjZW1lbnQ9ImxlZnQiIGRhdGEtb3JpZ2luYWwtdGl0bGU9IkNvcHkgbGVhZGVyYm9hcmQgKEwpIj5MQjwvYT4nICsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8YSBpZD0iY29weUlQQnRuIiBocmVmPSJqYXZhc2NyaXB0OnZvaWQoMCk7IiBjbGFzcz0iYnRuIGJ0bi1zbSBidG4tY29weS1sZWFkZXJib2FyZCBidG4taW5mbyIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6IHRyYW5zcGFyZW50OyB3aWR0aDogMTAwJTt0ZXh0LXNoYWRvdzogcmdiKDAsIDAsIDApIDAuM3B4IDAuM3B4O2ZvbnQtc2l6ZTogc21hbGw7bWFyZ2luLXRvcDogMHB4O2Rpc3BsYXk6IGJsb2NrO2JvcmRlcjogbm9uZTsgdXNlci1kcmFnOiBub25lOyB1c2VyLXNlbGVjdDogbm9uZTsgLW1vei11c2VyLXNlbGVjdDogbm9uZTsgLXdlYmtpdC11c2VyLWRyYWc6IG5vbmU7IC13ZWJraXQtdXNlci1zZWxlY3Q6IG5vbmU7IC1tcy11c2VyLXNlbGVjdDogbm9uZTsiIGRhdGEtdG9nZ2xlPSJ0b29sdGlwIiBkYXRhLXBsYWNlbWVudD0ibGVmdCIgZGF0YS1vcmlnaW5hbC10aXRsZT0iQ29weSBJUCBhZGRyZXNzIj5JUDwvYT4nICsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8L2Rpdj4nICsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8ZGl2IGlkPSJkcm9wRG93bjIiIGNsYXNzPSJodWQiIHN0eWxlPSJwb3NpdGlvbjogYWJzb2x1dGU7cG9pbnRlci1ldmVudHM6IGF1dG87d2lkdGg6IDMzJTtoZWlnaHQ6IDI5cHg7cmlnaHQ6IDBweDtwYWRkaW5nOiAwcHg7Ym9yZGVyLXJhZGl1czogMHB4OyI+JysNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8YSBpZD0iY3JlYXRlUGFydHlCdG4iIGhyZWY9ImphdmFzY3JpcHQ6dm9pZCgwKTsiIGNsYXNzPSJidG4gYnRuLXNtIGJ0bi1jb3B5LWxlYWRlcmJvYXJkIGJ0bi1pbmZvIiBzdHlsZT0iYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7d2lkdGg6IDEwMCU7dGV4dC1zaGFkb3c6IHJnYigwLCAwLCAwKSAwLjNweCAwLjNweDtmb250LXNpemU6IHNtYWxsO21hcmdpbi10b3A6IDBweDtkaXNwbGF5OiBibG9jaztib3JkZXI6IG5vbmU7IHVzZXItZHJhZzogbm9uZTsgdXNlci1zZWxlY3Q6IG5vbmU7IC1tb3otdXNlci1zZWxlY3Q6IG5vbmU7IC13ZWJraXQtdXNlci1kcmFnOiBub25lOyAtd2Via2l0LXVzZXItc2VsZWN0OiBub25lOyAtbXMtdXNlci1zZWxlY3Q6IG5vbmU7IiBkYXRhLXRvZ2dsZT0idG9vbHRpcCIgZGF0YS1wbGFjZW1lbnQ9ImxlZnQiIGRhdGEtb3JpZ2luYWwtdGl0bGU9IkNyZWF0ZSBwYXJ0eSI+PHNwYW4gY2xhc3M9ImdseXBoaWNvbiBnbHlwaGljb24tcGx1cyI+PC9zcGFuPjwvYT4nKw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8L2Rpdj4nKw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPGlucHV0IGlkPSJ0ZW1wQ29weSIgc3R5bGU9ImRpc3BsYXk6IG5vbmU7IiB2YWx1ZT0iIj4nICsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8L2Rpdj4nKTsNCg0KICAgICQoIiNzZWFyY2hTaG9ydGN1dCIpLm1vdXNlZW50ZXIoZnVuY3Rpb24gKCkgew0KICAgICAgICAkKCIjZHJvcERvd24iKS5oaWRlKCk7DQogICAgICAgIC8vICQoIiNkcm9wRG93bjIiKS5oaWRlKCk7DQogICAgICAgICQoIiNjb3B5VEtCdG4iKS50ZXh0KCJDb3B5Iik7DQogICAgfSk7DQogICAgJCgiI2NvcHlUS0J0biIpLm1vdXNlZW50ZXIoZnVuY3Rpb24gKCkgew0KICAgICAgICAkKCIjY29weVRLQnRuIikudGV4dCgiVEsiKTsNCiAgICAgICAgLy8gJCgiI2Ryb3BEb3duMiIpLmhpZGUoKTsNCiAgICAgICAgJCgiI2Ryb3BEb3duIikuc2hvdygxMDApOw0KICAgIH0pOw0KICAgICQoIiNsZWFkZXJib2FyZC1tZW51IikubW91c2VsZWF2ZShmdW5jdGlvbiAoKSB7DQogICAgICAgICQoIiNkcm9wRG93biIpLmhpZGUoKTsNCiAgICAgICAgLy8gJCgiI2Ryb3BEb3duMiIpLmhpZGUoKTsNCiAgICAgICAgJCgiI2NvcHlUS0J0biIpLnRleHQoIkNvcHkiKTsNCiAgICB9KTsNCg0KICAgICQoIiNsb2dUaXRsZSIpLmFmdGVyKCc8YSBocmVmPSIjIiBzdHlsZT0iY29sb3I6IGxpZ2h0Z3JleTtmbG9hdDogcmlnaHQ7cG9zaXRpb246IGFic29sdXRlO3JpZ2h0OiAxMnB4O3RvcDogOXB4OyIgY2xhc3M9Im1haW4tY29sb3IiIG9uY2xpY2s9IiQoJyNsb2cnKS5odG1sKCcnKTsiIGRhdGEtdG9nZ2xlPSJ0b29sdGlwIiBkYXRhLXBsYWNlbWVudD0ibGVmdCIgZGF0YS1vcmlnaW5hbC10aXRsZT0iQ2xlYXIgbGlzdCI+PHNwYW4gY2xhc3M9ImdseXBoaWNvbiBnbHlwaGljb24tYmFuLWNpcmNsZSI+PC9zcGFuPjwvYT4nKTsNCiAgICAkKCIjc2VhcmNoQnRuIikudG9vbHRpcCgnZGlzYWJsZScpOw0KDQogICAgJCgiI2NvcHlMQkJ0biIpLmNsaWNrKGZ1bmN0aW9uICgpIHsNCiAgICAgICAgY29weShnZXRMZWFkZXJib2FyZCgpKTsNCiAgICB9KTsNCg0KICAgICQoIiNjb3B5VEtCdG4iKS5jbGljayhmdW5jdGlvbiAoKSB7DQogICAgICAgIGNvcHkoImh0dHA6Ly9hZ2FyLmlvLyMiICsgY3VycmVudFRva2VuKTsNCiAgICB9KTsNCg0KICAgICQoIiNjb3B5SVBCdG4iKS5jbGljayhmdW5jdGlvbiAoKSB7DQogICAgICAgIGNvcHkoImh0dHA6Ly9hZ2FyLmlvLz9yPSIgKyBNQy5nZXRSZWdpb24oKSArICImbT0iICsgZ2V0R2FtZU1vZGUoKSArICImc2VhcmNoPXdzOi8vIiArIGN1cnJlbnRJUCk7DQogICAgfSk7DQoNCiAgICAkKCIjcmVjb25uZWN0QnRuIikuY2xpY2soZnVuY3Rpb24gKCkgew0KICAgICAgICBoaWRlTWVudSgpOw0KICAgICAgICBjaGFuZ2VTZXJ2ZXIoKTsNCg0KICAgICAgICBpZiAoISQoIiNzZWFyY2hIdWQiKS5pcygnOnZpc2libGUnKSkgew0KICAgICAgICAgICAgZGVsYXkoMjAwLCBzcGVjdGF0ZSk7DQogICAgICAgIH0NCiAgICB9KTsNCg0KICAgIC8qJCgiI2NyZWF0ZVBhcnR5QnRuIikuY2xpY2soZnVuY3Rpb24oKXsNCiAgICAgICAgaGlkZU1lbnUoKTsNCiAgICAgICAgJCgiI2NyZWF0ZS1wYXJ0eS1idG4iKS5jbGljaygpOw0KDQogICAgICAgIGlmICghJCgiI3NlYXJjaEh1ZCIpLmlzKCc6dmlzaWJsZScpKSB7DQogICAgICAgICAgICBkZWxheSgyMDAsIHNwZWN0YXRlKTsNCiAgICAgICAgfQ0KICAgIH0pOyovDQogICAgJCgiI3JlY29ubmVjdEJ0biIpLm1vdXNlZW50ZXIoZnVuY3Rpb24gKCkgew0KICAgICAgICAkKCIjZHJvcERvd24iKS5oaWRlKCk7DQogICAgICAgIC8vJCgiI2Ryb3BEb3duMiIpLnNob3coMTAwKTsNCiAgICAgICAgJCgiI2NvcHlUS0J0biIpLnRleHQoIkNvcHkiKTsNCiAgICB9KTsNCg0KICAgICQoIiNzZWFyY2hCdG4iKS5jbGljayhmdW5jdGlvbiAoKSB7DQogICAgICAgIHZhciBzZWFyY2hTdHJpbmcgPSAkKCIjc2VhcmNoSW5wdXQiKS52YWwoKTsNCiAgICAgICAgc2VhcmNoSGFuZGxlcihzZWFyY2hTdHJpbmcpOw0KICAgIH0pOw0KICAgICQoIiNzZWFyY2hJbnB1dCIpLmtleXVwKGZ1bmN0aW9uIChldmVudCkgew0KICAgICAgICBpZiAoZXZlbnQua2V5Q29kZSA9PSAxMykgew0KICAgICAgICAgICAgJCgiI3NlYXJjaEJ0biIpLmNsaWNrKCk7DQogICAgICAgIH0NCiAgICB9KTsNCg0KICAgICQoIiNjbG9zZUJ0biIpLmNsaWNrKGZ1bmN0aW9uICgpIHsNCiAgICAgICAgaGlkZVNlYXJjaEh1ZCgpOw0KICAgIH0pOw0KICAgICQoIiNzZWFyY2hTaG9ydGN1dCIpLmNsaWNrKGZ1bmN0aW9uICgpIHsNCiAgICAgICAgaGlkZU1lbnUoKTsNCiAgICAgICAgc2hvd1NlYXJjaEh1ZCgpOw0KICAgICAgICAkKCIjc2VhcmNoSW5wdXQiKS5mb2N1cygpLnNlbGVjdCgpOw0KICAgIH0pOw0KDQoNCiAgICB2YXIgb2dhcmlvVmVyc2lvbiA9ICQoIiNtZW51LWZvb3RlciIpLnRleHQoKS5zcGxpdCgifCAiKVsxXTsNCiAgICAkKCIjbWVudS1mb290ZXIiKS50ZXh0KCIiKTsNCiAgICAvLyBCdXJhc/0gOSBmb290ZXINCiAgICAkKCIjbWVudS1mb290ZXIiKS5wcmVwZW5kKCc8c3BhbiBzdHlsZT0iZmxvYXQ6IGxlZnQ7IGZvbnQtc2l6ZTogMTNweDsiPjxhIHRhcmdldD0iX2JsYW5rIiBvbmNsaWNrPSJnYSgnc2VuZCcsICdldmVudCcsICdMaW5rJywgJ2NsaWNrJywgJ0J1cmFz/SAxMCcpOyIgaHJlZj0iaHR0cDovL2FnYXIuaGFrYW5tZWR5YS5jb20vIiBzdHlsZT0iY29sb3I6ICNmZmZmZmY7IiBkYXRhLXRvZ2dsZT0idG9vbHRpcCIgZGF0YS10aXRsZT0iQVRBIENsYW4gV2ViIFNpdGUiIGRhdGEtcGxhY2VtZW50PSJsZWZ0Ij5EZXZlbG9wZXI6IHwmIzEzMzc7JiMxMzMzOyYjMTMzNzsmIzEyMzA1OyYjOTIzO0QmIzkyMzsmIzEwNDg7JiM5MjM7TEkgdicgKyBtb2RWZXJzaW9uICsgJzwvYT48L3NwYW4+JyArDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPGEgaHJlZj0iaHR0cDovL29nYXJpby5vdmgiIHRhcmdldD0iX2JsYW5rIj5PR0FSaW88L2E+ICcgKyBvZ2FyaW9WZXJzaW9uKTsNCg0KICAgIC8vIGRvbmF0ZSBidXR0b24NCiAgICAkKCIjbWVudS1mb290ZXIiKS5hZnRlcignPGEgaHJlZj0iaHR0cDovL2FnYXIuaGFrYW5tZWR5YS5jb20iPjxpbWcgc3JjPSJodHRwOi8vYWdhci5oYWthbm1lZHlhLmNvbS9iYW5uZXIucG5nIj48L2E+Jyk7DQoNCiAgICAvLyQoIiNtaW5pbWFwLXNlY3RvcnMiKS5hdHRyKCJzdHlsZSIsICJvcGFjaXR5OiAwLjI1OyIpOw0KDQogICAgLy8ga2V5YmluZHMNCg0KICAgICQoZG9jdW1lbnQpLmtleXVwKGZ1bmN0aW9uIChldmVudCkgew0KDQogICAgICAgIGlmIChldmVudC53aGljaCA9PSA4KSB7IC8vIHNlYXJjaA0KICAgICAgICAgICAgaWYgKCQoJ2lucHV0OmZvY3VzJykubGVuZ3RoID09IDApIHsNCiAgICAgICAgICAgICAgICAkKCIjc2VhcmNoU2hvcnRjdXQiKS5jbGljaygpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgIH0gZWxzZSBpZiAoZXZlbnQud2hpY2ggPT0gMTg3ICYmICEoJCgiaW5wdXQiKS5pcygiOmZvY3VzIikpICYmIG9nYXJpby5wbGF5ID09IGZhbHNlKSB7IC8vIHJlZnJlc2ggc2VydmVyDQogICAgICAgICAgICAkKCIjcmVjb25uZWN0QnRuIikuY2xpY2soKTsNCg0KICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LndoaWNoID09IDI3KSB7IC8vIEVTQ0FQRQ0KDQogICAgICAgICAgICBpZiAoJCgnI3NlYXJjaEh1ZCcpLmlzKCc6dmlzaWJsZScpKSB7DQogICAgICAgICAgICAgICAgaGlkZVNlYXJjaEh1ZCgpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBzaG93TWVudSgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICB9KTsNCg0KICAgICQoZG9jdW1lbnQpLmtleWRvd24oZnVuY3Rpb24gKGV2ZW50KSB7DQogICAgICAgIGlmIChldmVudC53aGljaCA9PSA4MSAmJiBvZ2FyaW8uc3BlY3RhdGUgJiYgISgkKCJpbnB1dCIpLmlzKCI6Zm9jdXMiKSkpIHsgLy8gc3BlY3RhdGUgJ1EnIGZpeA0KICAgICAgICAgICAgc3BlY3RhdGUoKTsNCiAgICAgICAgfQ0KICAgIH0pOw0KDQogICAgJCgiI3RpbWUtaHVkIikuYXR0cigic3R5bGUiLCAidG9wOiAyOTBweCAhaW1wb3J0YW50OyIpOw0KDQogICAgLy8gZml4IHRpbWUNCiAgICAvKmlmKCQoIiNzaG93VGltZSIpLmlzKCc6Y2hlY2tlZCcpKSB7DQogICAgICAgICQoIiN0aW1lLWh1ZCIpLnNob3coKTsNCiAgICB9IGVsc2Ugew0KICAgICAgICAkKCIjdGltZS1odWQiKS5oaWRlKCk7DQogICAgfSovDQoNCiAgICAvLyBmaXggbGVhZGVyYm9hcmQgYnV0dG9ucw0KICAgICQoIiNsZWFkZXJib2FyZC1tZW51IikuY3NzKCJwb2ludGVyLWV2ZW50cyIsICJhdXRvIik7DQogICAgJCgiI3NlYXJjaEh1ZCIpLmNzcygicG9pbnRlci1ldmVudHMiLCAiYXV0byIpOw0KDQogICAgLy8gZml4IHN0YXRzIHRleHQgc2l6ZQ0KICAgICQoJ1tpZD0ic3RhdHNUZXh0Il0nKS5jc3MoImZvbnQtc2l6ZSIsICJtZWRpdW0iKTsNCg0KICAgIC8vIGRldGVjdCBwYXN0ZQ0KICAgICQoZG9jdW1lbnQpLmJpbmQoInBhc3RlIiwgZnVuY3Rpb24gKGUpIHsNCiAgICAgICAgaWYgKCFzZWFyY2hpbmcgJiYgISgkKCJpbnB1dCx0ZXh0YXJlYSIpLmlzKCI6Zm9jdXMiKSkpIHsNCiAgICAgICAgICAgIHZhciBwYXN0ZWREYXRhID0gZS5vcmlnaW5hbEV2ZW50LmNsaXBib2FyZERhdGEuZ2V0RGF0YSgndGV4dCcpOw0KICAgICAgICAgICAgaGlkZU1lbnUoKTsNCiAgICAgICAgICAgIHNob3dTZWFyY2hIdWQoKTsNCiAgICAgICAgICAgICQoIiNzZWFyY2hJbnB1dCIpLnZhbChwYXN0ZWREYXRhKTsNCiAgICAgICAgICAgICQoIiNzZWFyY2hJbnB1dCIpLnNlbGVjdCgpOw0KICAgICAgICAgICAgc2VhcmNoSGFuZGxlcihwYXN0ZWREYXRhKTsNCiAgICAgICAgfQ0KICAgIH0pOw0KDQogICAgJCgiI3NlYXJjaElucHV0IikuYmluZCgicGFzdGUiLCBmdW5jdGlvbiAoZSkgew0KICAgICAgICBpZiAoIXNlYXJjaGluZykgew0KICAgICAgICAgICAgdmFyIHBhc3RlZERhdGEgPSBlLm9yaWdpbmFsRXZlbnQuY2xpcGJvYXJkRGF0YS5nZXREYXRhKCd0ZXh0Jyk7DQogICAgICAgICAgICAkKCIjc2VhcmNoSW5wdXQiKS52YWwocGFzdGVkRGF0YSk7DQogICAgICAgICAgICAkKCIjc2VhcmNoSW5wdXQiKS5zZWxlY3QoKTsNCiAgICAgICAgICAgIHNlYXJjaEhhbmRsZXIocGFzdGVkRGF0YSk7DQogICAgICAgIH0NCiAgICB9KTsNCg0KICAgIC8vbG9hZCBub3Rlcw0KICAgICQoIiNub3RlMSIpLnZhbChsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnbm90ZTEnKSk7DQogICAgJCgiI25vdGUyIikudmFsKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdub3RlMicpKTsNCiAgICAkKCIjbm90ZTMiKS52YWwobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ25vdGUzJykpOw0KICAgICQoIiNub3RlNCIpLnZhbChsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnbm90ZTQnKSk7DQogICAgJCgiI25vdGU1IikudmFsKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdub3RlNScpKTsNCiAgICAkKCIjbm90ZTYiKS52YWwobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ25vdGU2JykpOw0KICAgICQoIiNub3RlNyIpLnZhbChsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnbm90ZTcnKSk7DQoNCiAgICAvLyBsaXN0ZW4gZm9yIHNlcnZlciBkaXNjb25uZWN0DQogICAgTUMub25EaXNjb25uZWN0ID0gZnVuY3Rpb24gKCkgew0KICAgICAgICB0b2FzdHJbImVycm9yIl0oIkRpc2Nvbm5lY3RlZCBmcm9tIHNlcnZlciA6KCIpLmNzcygid2lkdGgiLCAiMjEwcHgiKTsNCiAgICAgICAgYXBwZW5kU3lzTG9nKCJESVNDT05ORUNURUQgOigiKTsNCiAgICB9Ow0KDQogICAgLy8gbGlzdGVuIGZvciBwbGF5ZXIgYmFuDQogICAgTUMub25QbGF5ZXJCYW5uZWQgPSBmdW5jdGlvbiAoKSB7DQogICAgICAgIHRvYXN0clsiZXJyb3IiXSgiWW91IHdlcmUgYmFubmVkLCByZXN0YXJ0IHlvdXIgcm9vdGVyISIpLmNzcygid2lkdGgiLCAiMjEwcHgiKTsNCiAgICAgICAgYXBwZW5kU3lzTG9nKCJCQU4gOigiKTsNCiAgICB9Ow0KDQogICAgJCgiI3JlZ2lvbiIpLnJlYWR5KGZ1bmN0aW9uICgpIHsgZGVsYXkoMjAwMCwgZ2V0SW5mbyk7IH0pOw0KDQogICAgJCgnYm9keScpLm9uKCdjbGljaycsICcubG9nRW50cnknLCBmdW5jdGlvbiAoKSB7DQoNCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NlYXJjaElucHV0JykudmFsdWUgPSAiaHR0cDovL2FnYXIuaW8vIyIgKyAkKHRoaXMpLmRhdGEoJ3Rva2VuJyk7DQogICAgICAgIGJ1bXBMb2coKTsNCiAgICAgICAgZ2V0SW5mbygpOw0KICAgICAgICBzZWFyY2hUS0hhbmRsZXIoJCgiI3NlYXJjaElucHV0IikudmFsKCkpOw0KDQogICAgfSk7DQoNCiAgICAkKCdib2R5Jykub24oJ2NsaWNrJywgJy5idG4tcGxheS1zaG9ydGN1dCcsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgaGlkZVNlYXJjaEh1ZCgpOw0KICAgICAgICB0b2FzdHIuY2xlYXIoKTsNCiAgICAgICAgcGxheSgpOw0KICAgIH0pOw0KICAgICQoJ2JvZHknKS5vbignY2xpY2snLCAnLmJ0bi1zcGVjdGF0ZS1zaG9ydGN1dCcsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgaGlkZVNlYXJjaEh1ZCgpOw0KICAgICAgICB0b2FzdHIuY2xlYXIoKTsNCiAgICAgICAgc3BlY3RhdGUoKTsNCiAgICB9KTsNCg0KDQogICAgJCgiI3JlZ2lvbiwgI2dhbWVtb2RlIikuY2hhbmdlKGZ1bmN0aW9uICgpIHsNCiAgICAgICAgYXBwZW5kTG9nKGdldExlYWRlcmJvYXJkKCkpOw0KICAgIH0pOw0KDQogICAgLy8gaGlkZSBleHAgYmFyDQogICAgJCgiI2V4cC1iYXIiKS5yZW1vdmUoKTsNCg0KICAgIC8vIGhpZGUgcGFydHkgZm9ybQ0KICAgICQoIiNvZ2FyaW8tcGFydHkiKS53cmFwKCc8ZGl2IHN0eWxlPSJkaXNwbGF5OiBub25lOyI+PC9kaXY+Jyk7DQoNCiAgICB2YXIgdXJsID0gd2luZG93LmxvY2F0aW9uLmhyZWY7ICAgICAvLyBSZXR1cm5zIGZ1bGwgVVJMDQogICAgLyppZiAodXJsLmxlbmd0aCAhPT0gMjEpIHsNCiAgICAgICAgJCgiI29nYXJpby1wYXJ0eSIpLmhpZGUoKTsNCiAgICB9Ki8NCg0KDQogICAgJCgiI2dhbWVtb2RlIikuY2hhbmdlKGZ1bmN0aW9uICgpIHsNCiAgICAgICAgaWYgKCQoIiNnYW1lbW9kZSIpLnZhbCgpID09ICI6cGFydHkiKSB7DQogICAgICAgICAgICAkKCIjb2dhcmlvLXBhcnR5Iikuc2hvdygpOw0KICAgICAgICAgICAgJCgiI2pvaW5QYXJ0eVRva2VuIikudmFsKCIiKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICQoIiNvZ2FyaW8tcGFydHkiKS5oaWRlKCk7DQogICAgICAgIH0NCiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oImdhbWVtb2RlIiwgb2dhcmlvLmdhbWVNb2RlKTsNCiAgICB9KTsNCg0KICAgIC8vIHN0eWxlIGJ1dHRvbnMNCiAgICAkKCIuYnRuLXNwZWN0YXRlLCAuYnRuLWxvZ291dCIpLmF0dHIoInN0eWxlIiwgImJvcmRlci10b3A6IG5vbmU7IGJvcmRlci1sZWZ0OiBub25lOyBib3JkZXItcmlnaHQ6IG5vbmU7Iik7DQoNCiAgICAkKCIjcmVnaW9uIikuY2hhbmdlKGZ1bmN0aW9uICgpIHsNCiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oImxvY2F0aW9uMiIsIE1DLmdldFJlZ2lvbigpKTsNCiAgICB9KTsNCg0KICAgICQoZG9jdW1lbnQpLmFqYXhDb21wbGV0ZShmdW5jdGlvbiAoZXZlbnQsIHhociwgc2V0dGluZ3MpIHsNCiAgICAgICAgLy9jb25zb2xlLmxvZyh4aHIpOw0KICAgICAgICAvL2NvbnNvbGUubG9nKHNldHRpbmdzKTsNCg0KICAgICAgICBpZiAoeGhyLnJlc3BvbnNlSlNPTiAhPSBudWxsKSB7DQogICAgICAgICAgICBpZiAoeGhyLnJlc3BvbnNlSlNPTi5pcCAhPSBudWxsICYmIHhoci5yZXNwb25zZUpTT04uaGFzT3duUHJvcGVydHkoJ2lwJykpIHsNCiAgICAgICAgICAgICAgICBjdXJyZW50SVAgPSB4aHIucmVzcG9uc2VKU09OLmlwOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoeGhyLnJlc3BvbnNlSlNPTi50b2tlbiAhPSBudWxsICYmIHhoci5yZXNwb25zZUpTT04uaGFzT3duUHJvcGVydHkoJ3Rva2VuJykpIHsNCiAgICAgICAgICAgICAgICBjdXJyZW50VG9rZW4gPSB4aHIucmVzcG9uc2VKU09OLnRva2VuOw0KICAgICAgICAgICAgICAgIGlmIChsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgic2hvd1RLIikgPT0gInRydWUiIHx8IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJzaG93VEsiKSA9PSBudWxsKSB7DQogICAgICAgICAgICAgICAgICAgICQoIiNjdXItdGstaHVkIikuZmFkZVRvKCdmYXN0JywgMC4yKS5mYWRlVG8oJ2Zhc3QnLCAxLjApOw0KICAgICAgICAgICAgICAgICAgICAkKCIjY3VyLXRrLWh1ZCIpLnRleHQoIlRLOiAjIiArIGN1cnJlbnRUb2tlbik7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIC8vam9pblRva2VuKGN1cnJlbnRUb2tlbi5yZXBsYWNlKCJodHRwOi8vYWdhci5pby8jIiwgIiIpKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIGlmICh4aHIuc3RhdHVzID09IDIwMCAmJiBzZXR0aW5ncy51cmwgPT0gImh0dHA6Ly9tLmFnYXIuaW8vZ2V0VG9rZW4iKSB7DQogICAgICAgICAgICAvL3RvYXN0clsiaW5mbyJdKCJDb25uZWN0ZWQgOikiKS5jc3MoIndpZHRoIiwiMjEwcHgiKTsNCiAgICAgICAgICAgIGRlbGF5KDIwMCwgc3BlY3RhdGUpOw0KICAgICAgICAgICAgdG9hc3RyWyJpbmZvIl0oJ0Nvbm5lY3RlZCE8L2JyPiA8YnV0dG9uIGNsYXNzPSJidG4gYnRuLXNtIGJ0bi1wcmltYXJ5IGJ0bi1wbGF5IGJ0bi1wbGF5LXNob3J0Y3V0IiBzdHlsZT0ibWFyZ2luLXRvcDogMTBweDtib3JkZXItY29sb3I6IGRhcmtibHVlOyI+UExBWTwvYnV0dG9uPjxicj48YnV0dG9uIGNsYXNzPSJidG4gYnRuLXNtIGJ0bi13YXJuaW5nIGJ0bi1zcGVjdGF0ZSBidG4tc3BlY3RhdGUtc2hvcnRjdXQiIHN0eWxlPSJ3aWR0aDogMTAwJTttYXJnaW4tdG9wOiAxMHB4OyI+U1BFQ1RBVEU8L2J1dHRvbj4nLCAiIiwgeyB0aW1lT3V0OiAyMDAwMCwgZXh0ZW5kZWRUaW1lT3V0OiAyMDAwMCB9KS5jc3MoIndpZHRoIiwgIjIxMHB4Iik7DQogICAgICAgIH0NCiAgICB9KTsNCg0KICAgICQoZG9jdW1lbnQpLmFqYXhFcnJvcihmdW5jdGlvbiAoZXZlbnQsIHhociwgc2V0dGluZ3MpIHsNCiAgICAgICAgLy9jb25zb2xlLmxvZyh4aHIpOw0KICAgICAgICAvL2NvbnNvbGUubG9nKGV2ZW50KTsNCiAgICAgICAgLy9jb25zb2xlLmxvZyhzZXR0aW5ncyk7DQoNCiAgICAgICAgaWYgKHhoci5zdGF0dXMgPT0gNDA0ICYmIHNldHRpbmdzLnVybCA9PSAiaHR0cDovL20uYWdhci5pby9nZXRUb2tlbiIpIHsNCiAgICAgICAgICAgIHRvYXN0clsiZXJyb3IiXSgiSW52YWxpZCB0b2tlbiBvciBzZXJ2ZXIgaGFzIGNsb3NlZCA6KCIpLmNzcygid2lkdGgiLCAiMjEwcHgiKTsNCiAgICAgICAgICAgICQoJyNoZWxsb0NvbnRhaW5lcicpLmF0dHIoJ2RhdGEtcGFydHktc3RhdGUnLCAnMCcpOw0KICAgICAgICB9DQogICAgfSk7DQoNCiAgICAvLyBzZWFyY2ggSVAgaW4gcXVlcnkNCiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsNCg0KICAgICAgICB2YXIgdXJsID0gd2luZG93LmxvY2F0aW9uLmhyZWY7DQogICAgICAgIHZhciByZWdpb24gPSBnZXRQYXJhbWV0ZXJCeU5hbWUoInIiLCB1cmwpOw0KICAgICAgICB2YXIgbW9kZSA9IGdldFBhcmFtZXRlckJ5TmFtZSgibSIsIHVybCk7DQogICAgICAgIHZhciBzZWFyY2hTdHIgPSBnZXRQYXJhbWV0ZXJCeU5hbWUoInNlYXJjaCIsIHVybCk7DQoNCiAgICAgICAgaWYgKHVybC5sZW5ndGggPT0gMjEpIHsNCg0KICAgICAgICAgICAgam9pblRva2VuKHVybC5yZXBsYWNlKCJodHRwOi8vYWdhci5pby8jIiwgIiIpKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGlmIChyZWdpb24gIT0gbnVsbCkgew0KDQogICAgICAgICAgICAgICAgTUMuc2V0UmVnaW9uKHJlZ2lvbik7DQogICAgICAgICAgICAgICAgTUMuc2V0R2FtZU1vZGUobW9kZSk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIC8vIGJ1ZyBmaXgNCiAgICAgICAgICAgICAgICBNQy5zZXRSZWdpb24obG9jYWxTdG9yYWdlLmdldEl0ZW0oImxvY2F0aW9uMiIpKTsNCiAgICAgICAgICAgICAgICBNQy5zZXRHYW1lTW9kZShwcmV2aW91c01vZGUpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKHNlYXJjaFN0ciAhPSBudWxsICYmIHNlYXJjaFN0cikgew0KDQogICAgICAgICAgICBpZiAoc2VhcmNoSVBIYW5kbGVyKHNlYXJjaFN0cikpIHsNCiAgICAgICAgICAgICAgICBoaWRlTWVudSgpOw0KICAgICAgICAgICAgICAgIHNob3dTZWFyY2hIdWQoKTsNCiAgICAgICAgICAgICAgICBzaG93Q2FuY2VsU2VhcmNoKCk7DQogICAgICAgICAgICAgICAgJCgiI3NlYXJjaElucHV0IikudmFsKHNlYXJjaFN0cik7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgIH0sIDEwMDAwKTsgLy8xMA0KDQogICAgJCgiI2F1dG9Db2luQnRuIikuY2xpY2soZnVuY3Rpb24gKCkgew0KDQogICAgICAgIHZhciBjaGVja2VkID0gISgkKHRoaXMpLmF0dHIoJ2FyaWEtcHJlc3NlZCcpID09ICJ0cnVlIik7DQogICAgICAgIGlmIChjaGVja2VkKSB7DQogICAgICAgICAgICBzdGFydENvaW5NaW5pbmcoKTsNCiAgICAgICAgICAgICQodGhpcykuaHRtbCgnPGkgY2xhc3M9ImZhIGZhLWNsb2NrLW8iPjwvaT4gU3RvcCBmcmVlIGNvaW5zJyk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBzdG9wQ29pbk1pbmluZygpOw0KICAgICAgICAgICAgJCh0aGlzKS5odG1sKCc8aSBjbGFzcz0iZmEgZmEtY2xvY2stbyI+PC9pPiBBdXRvIGZyZWUgY29pbnMnKTsNCiAgICAgICAgfQ0KDQogICAgfSk7DQoNCiAgICAkKCIjYXV0b1Jlc3Bhd25CdG4iKS5jbGljayhmdW5jdGlvbiAoKSB7DQoNCiAgICAgICAgdmFyIGNoZWNrZWQgPSAhKCQodGhpcykuYXR0cignYXJpYS1wcmVzc2VkJykgPT0gInRydWUiKTsNCiAgICAgICAgaWYgKGNoZWNrZWQpIHsNCg0KICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oImF1dG9SZXNwYXduIiwgdHJ1ZSk7DQoNCiAgICAgICAgICAgIC8vIGF1dG8gcmVzcGF3bg0KICAgICAgICAgICAgLy92YXIgcHJveHlPbkRlYXRoID0gTUMub25QbGF5ZXJEZWF0aDsNCiAgICAgICAgICAgIE1DLm9uUGxheWVyRGVhdGggPSBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgdmFyIGlzVmlzaWJsZU1lbnUgPSAkKCIjbWFpbi1tZW51IikuaXMoJzp2aXNpYmxlJyk7DQogICAgICAgICAgICAgICAgdmFyIGlzVmlzaWJsZVNlYXJjaEh1ZCA9ICQoIiNzZWFyY2hIdWQiKS5pcygnOnZpc2libGUnKTsNCiAgICAgICAgICAgICAgICB2YXIgYXV0b1Jlc3Bhd24gPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgiYXV0b1Jlc3Bhd24iKTsNCiAgICAgICAgICAgICAgICAvL3Byb3h5T25EZWF0aCgpOw0KDQogICAgICAgICAgICAgICAgLy8gZGlzYWJsZSBzdGF0cw0KICAgICAgICAgICAgICAgIGlmICghJCgiI3NraXBTdGF0cyIpLmlzKCc6Y2hlY2tlZCcpKSB7ICQoIiNza2lwU3RhdHMiKS5jbGljaygpIH0NCg0KICAgICAgICAgICAgICAgIGlmIChhdXRvUmVzcGF3biAhPSBudWxsICYmIGF1dG9SZXNwYXduID09ICJ0cnVlIiAmJiAhaXNWaXNpYmxlTWVudSAmJiAhaXNWaXNpYmxlU2VhcmNoSHVkICYmICEoJCgiaW5wdXQiKS5pcygiOmZvY3VzIikpKSB7DQogICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgeyBwbGF5KCk7IH0sIDE1MDApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH07DQoNCiAgICAgICAgICAgICQodGhpcykuaHRtbCgnPGkgY2xhc3M9ImZhIGZhLWZsYXNoIj48L2k+IFN0b3AgcmVzcGF3bicpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oImF1dG9SZXNwYXduIiwgZmFsc2UpOw0KICAgICAgICAgICAgTUMub25QbGF5ZXJEZWF0aCA9IG9yaWdpbmFsRGVhdGg7DQogICAgICAgICAgICAkKHRoaXMpLmh0bWwoJzxpIGNsYXNzPSJmYSBmYS1mbGFzaCI+PC9pPiBBdXRvIHJlc3Bhd24nKTsNCiAgICAgICAgfQ0KDQogICAgfSk7DQoNCg0KDQogICAgLy8gc2hvdyB0b2tlbg0KICAgICQoIiNzaG93Q3VyVEtCdG4iKS5jbGljayhmdW5jdGlvbiAoKSB7DQoNCiAgICAgICAgdmFyIGNoZWNrZWQgPSAhKCQodGhpcykuYXR0cignYXJpYS1wcmVzc2VkJykgPT0gInRydWUiKTsNCiAgICAgICAgaWYgKGNoZWNrZWQpIHsNCiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCJzaG93VEsiLCB0cnVlKTsNCiAgICAgICAgICAgICQoIiNjdXItdGstaHVkIikuc2hvdygpOw0KICAgICAgICAgICAgJCgiI2N1ci10ay1odWQiKS50ZXh0KCJUSzogIyIgKyBjdXJyZW50VG9rZW4pOw0KICAgICAgICAgICAgJCh0aGlzKS50ZXh0KCdIaWRlIHRva2VuJyk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgic2hvd1RLIiwgZmFsc2UpOw0KICAgICAgICAgICAgJCgiI2N1ci10ay1odWQiKS5oaWRlKCk7DQogICAgICAgICAgICAkKHRoaXMpLnRleHQoJ1Nob3cgdG9rZW4nKTsNCiAgICAgICAgfQ0KDQogICAgfSk7DQoNCiAgICAvLyBzaG93IHBsYXllcg0KICAgICQoIiNzaG93UGxheWVyQnRuIikuY2xpY2soZnVuY3Rpb24gKCkgew0KDQogICAgICAgIHZhciBjaGVja2VkID0gISgkKHRoaXMpLmF0dHIoJ2FyaWEtcHJlc3NlZCcpID09ICJ0cnVlIik7DQogICAgICAgIGlmIChjaGVja2VkKSB7DQogICAgICAgICAgICAkKCIjcGxheWVyLWh1ZCIpLnNob3coKTsNCiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCJzaG93UGxheWVyIiwgdHJ1ZSk7DQogICAgICAgICAgICAkKHRoaXMpLnRleHQoJ0hpZGUgcGxheWVyJyk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkKCIjcGxheWVyLWh1ZCIpLmhpZGUoKTsNCiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCJzaG93UGxheWVyIiwgZmFsc2UpOw0KICAgICAgICAgICAgJCh0aGlzKS50ZXh0KCdTaG93IHBsYXllcicpOw0KICAgICAgICB9DQoNCiAgICB9KTsNCg0KICAgICQoIiNzdGF0cy1odWQiKS5hZnRlcignPGRpdiBpZD0iY3VyLXRrLWh1ZCIgY2xhc3M9Imh1ZCBtYWluLWNvbG9yIGh1ZC10b3AiIHN0eWxlPSIgcmlnaHQ6IDIyMHB4OyBmb250LXNpemU6IDE1cHg7IHBhZGRpbmc6IDZweDsiPjwvZGl2PicpOw0KICAgICQoIiNtaW5pbWFwLWh1ZCIpLmJlZm9yZSgnPGRpdiBpZD0icGxheWVyLWh1ZCIgY2xhc3M9Imh1ZCIgc3R5bGU9ImJvdHRvbTogMjMwcHg7cmlnaHQ6IDEwcHg7IHdpZHRoOiAzMHB4O2hlaWdodDogMzBweDtwYWRkaW5nOiAwcHg7cG9pbnRlci1ldmVudHM6IGF1dG87Ij4nICsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzxidXR0b24gaWQ9InBsYXllckJ0biIgY2xhc3M9ImJ0bi1saW5rIiBzdHlsZT0icGFkZGluZzogMHB4OyBjb2xvcjogI2Q2ZDNkMzsgd2lkdGg6IDEwMCU7IGhlaWdodDogMTAwJTsiIGRhdGEtb3JpZ2luYWwtdGl0bGU9IlBsYXkiPicgKw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPGkgaWQ9InBsYXllckkiIGNsYXNzPSJmYSBmYS1wbGF5LWNpcmNsZSIgc3R5bGU9InBhZGRpbmctbGVmdDogMHB4OyI+PC9pPjwvYnV0dG9uPjwvZGl2PicpOw0KDQogICAgJCgiI3BsYXllckJ0biIpLnRvb2x0aXAoKTsNCg0KDQogICAgLy8gcGxheWVyIHNob3J0Y3V0DQoNCiAgICAkKCIjcGxheWVyQnRuIikuY2xpY2soZnVuY3Rpb24gKCkgew0KICAgICAgICBpZiAobXVzaWNQbGF5ZXIgIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICB2YXIgcGxheWVyU3RhdGUgPSBtdXNpY1BsYXllci5nZXRQbGF5ZXJTdGF0ZSgpOw0KICAgICAgICAgICAgaWYgKHBsYXllclN0YXRlICE9IDEpIHsNCiAgICAgICAgICAgICAgICBtdXNpY1BsYXllci5wbGF5VmlkZW8oKTsNCiAgICAgICAgICAgICAgICAkKCIjcGxheWVySSIpLnJlbW92ZUNsYXNzKCJmYS1wbGF5LWNpcmNsZSIpLmFkZENsYXNzKCJmYS1wYXVzZS1jaXJjbGUiKTsNCiAgICAgICAgICAgICAgICAkKHRoaXMpLmF0dHIoJ2RhdGEtb3JpZ2luYWwtdGl0bGUnLCAiUGF1c2UiKS50b29sdGlwKCdmaXhUaXRsZScpLnRvb2x0aXAoJ3Nob3cnKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgbXVzaWNQbGF5ZXIucGF1c2VWaWRlbygpOw0KICAgICAgICAgICAgICAgICQoIiNwbGF5ZXJJIikucmVtb3ZlQ2xhc3MoImZhLXBhdXNlLWNpcmNsZSIpLmFkZENsYXNzKCJmYS1wbGF5LWNpcmNsZSIpOw0KICAgICAgICAgICAgICAgICQodGhpcykuYXR0cignZGF0YS1vcmlnaW5hbC10aXRsZScsICJQbGF5IikudG9vbHRpcCgnZml4VGl0bGUnKS50b29sdGlwKCdzaG93Jyk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9KTsNCg0KICAgICQoJypbZGF0YS1pdHI9InBhZ2VfcGxheSJdJykuY2xpY2soZnVuY3Rpb24gKCkgew0KICAgICAgICBnYSgnc2VuZCcsICdldmVudCcsICdUb2tlbicsIG9nYXJpby5wbGF5ZXJOaWNrICsgJyB8IGFnYXIuaW8vIycgKyBjdXJyZW50VG9rZW4pOw0KICAgICAgICBnYSgnc2VuZCcsICdldmVudCcsICdUYWcnLCBvZ2FyaW8ucGxheWVyTmljayArICcgfCAnICsgb2dhcmlvLmNsYW5UYWcpOw0KICAgICAgICBnYSgnc2VuZCcsICdldmVudCcsICdQbGF5ZXJJZCcsIG9nYXJpby5wbGF5ZXJOaWNrICsgJyB8ICcgKyAkKCIjdXNlci1pZC10YWciKS50ZXh0KCkuc3BsaXQoIjogIilbMV0pOw0KICAgIH0pOw0KICAgIC8vIGxvYWQgdG9vbHRpcHMNCiAgICAkKCdbZGF0YS10b2dnbGU9InRvb2x0aXAiXScpLnRvb2x0aXAoKTsNCg0KICAgIC8vIGxvYWQgQnVyYXP9IDEzIHNldHRpbmdzDQogICAgdmFyIGF1dG9SZXNwYXduID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oImF1dG9SZXNwYXduIik7DQogICAgdmFyIHNob3dUb2tlbiA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJzaG93VEsiKTsNCiAgICB2YXIgc2hvd1BsYXllciA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJzaG93UGxheWVyIik7DQogICAgaWYgKGF1dG9SZXNwYXduID09ICJ0cnVlIikgeyAkKCIjYXV0b1Jlc3Bhd25CdG4iKS5jbGljaygpOyB9DQogICAgaWYgKHNob3dUb2tlbiA9PSAidHJ1ZSIgfHwgc2hvd1BsYXllciA9PSBudWxsKSB7ICQoIiNjdXItdGstaHVkIikuc2hvdygpOyAkKCIjc2hvd0N1clRLQnRuIikuY2xpY2soKTsgfQ0KICAgIGlmIChzaG93UGxheWVyID09ICJ0cnVlIiB8fCBzaG93UGxheWVyID09IG51bGwpIHsgJCgiI3Nob3dQbGF5ZXJCdG4iKS5jbGljaygpOyB9DQoNCiAgICAvLyBmaXggbWFpbiBtZW51IHBsYWNlbWVudCBhZnRlciBzdGF0cw0KICAgICQoIiNzdGF0c0NvbnRpbnVlMiIpLmNsaWNrKGZ1bmN0aW9uICgpIHsgJCgiI21haW4tbWVudSA+IHVsID4gbGkuc3RhcnQtdGFiID4gYSIpLmNsaWNrKCkgfSk7DQoNCiAgICAvLyBzYXZlIG9yaWdpbmFsIGRlYXRoIGZ1bmN0aW9uDQogICAgb3JpZ2luYWxEZWF0aCA9IE1DLm9uUGxheWVyRGVhdGg7DQoNCiAgICAvLyByZW1vdmUgbGVhZGVyYm9hcmQgc2V0dGluZw0KICAgICQoIiNub3JtYWxMYiIpLnBhcmVudCgpLnJlbW92ZSgpOw0KICAgICQoIiNsZWFkZXJib2FyZC1odWQgPiBoNCIpLnRleHQoIkxFQURFUiBCT0FSRCIpOw0KDQogICAgLy8gZml4IHBhcnR5IHN0dWZmDQogICAgJCgnI2dhbWVtb2RlJykub24oJ2NoYW5nZScsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgaWYgKHRoaXMudmFsdWUgPT0gIjpwYXJ0eSIpIHsgJCgiI2NyZWF0ZS1wYXJ0eS1idG4iKS5jbGljaygpOyB9DQogICAgfSk7DQoNCiAgICAvLyBBRFMNCiAgICAkKCIjbWFpbi1wYW5lbCIpLmFwcGVuZCgnPGRpdiBpZD0iQnVyYXP9IDE2QWRzIj48L2Rpdj4nKTsNCiAgICB2YXIgdGFnMSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJuaWNrIikudmFsdWU7DQoJaWYodGFnMS5pbmNsdWRlcygiJiMxMDEwMjsiKT09dHJ1ZSl7DQogICAgJCgiI0J1cmFz/SAxN0FkcyIpLmxvYWQoImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9IYWthbk1lZHlhY2xhbi9tb2QvbWFzdGVyLy5iYW5uZXIiKTsNCiAgICB9DQogICAgZWxzZXsNCgkkKCIjQnVyYXP9IDE4QWRzIikubG9hZCgiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0hha2FuTWVkeWFjbGFuL21vZC9tYXN0ZXIvLmJhbm5lcjIiKTsNCiAgICB9DQogICAgLy8gQU5OT1VOQ0VNRU5UUw0KICAgIHZhciBuaWNrMSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJuaWNrIikudmFsdWU7DQogICAgdG9hc3RyWyJpbmZvIl0oJ01lcmhhYmEgJyArIG5pY2sxICsnISA8L2JyPt15aSBPeXVubGFyL0dvb2QgR2FtZXMgOik8L2E+Jyk7DQoNCn0sIDYwMDApOw0KDQoNCnZhciBzZWFyY2hpbmc7DQp2YXIgdGltZXJJZDsNCg0KZnVuY3Rpb24gZGVsYXkodGltZSwgZnVuYykgew0KICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgeyBmdW5jKCk7IH0sIHRpbWUpOw0KfQ0KDQpmdW5jdGlvbiBzcGVjdGF0ZSgpIHsNCiAgICBoaWRlTWVudSgpOw0KICAgICQoIi5idG4tc3BlY3RhdGUiKS5jbGljaygpOw0KfQ0KDQpmdW5jdGlvbiBjaGFuZ2VTZXJ2ZXIoKSB7DQogICAgTUMuc2V0R2FtZU1vZGUob2dhcmlvLmdhbWVNb2RlKTsNCiAgICBNQy5yZWNvbm5lY3QoKTsNCiAgICBhcHBlbmRMb2coZ2V0TGVhZGVyYm9hcmQoKSk7DQp9DQoNCmZ1bmN0aW9uIGlzVmFsaWRJcEFuZFBvcnQoaW5wdXQpIHsNCiAgICB2YXIgcGFydHMgPSBpbnB1dC5zcGxpdCgiOiIpOw0KICAgIHZhciBpcCA9IHBhcnRzWzBdLnNwbGl0KCIuIik7DQogICAgdmFyIHBvcnQgPSBwYXJ0c1sxXTsNCiAgICByZXR1cm4gdmFsaWRhdGVOdW0ocG9ydCwgMSwgNjU1MzUpICYmDQogICAgICAgIGlwLmxlbmd0aCA9PSA0ICYmDQogICAgICAgIGlwLmV2ZXJ5KGZ1bmN0aW9uIChzZWdtZW50KSB7DQogICAgICAgICAgICByZXR1cm4gdmFsaWRhdGVOdW0oc2VnbWVudCwgMCwgMjU1KTsNCiAgICAgICAgfSk7DQp9DQoNCmZ1bmN0aW9uIHZhbGlkYXRlTnVtKGlucHV0LCBtaW4sIG1heCkgew0KICAgIHZhciBudW0gPSAraW5wdXQ7DQogICAgcmV0dXJuIG51bSA+PSBtaW4gJiYgbnVtIDw9IG1heCAmJiBpbnB1dCA9PT0gbnVtLnRvU3RyaW5nKCk7DQp9DQoNCmZ1bmN0aW9uIGpvaW5Ub2tlbih0b2tlbikgew0KICAgIC8vdmFyIGxhc3RNb2RlID0gJCgiI2dhbWVtb2RlIikudmFsKCk7DQogICAgYXBwZW5kTG9nKGdldExlYWRlcmJvYXJkKCkpOw0KICAgICQoIiNqb2luUGFydHlUb2tlbiIpLnZhbCh0b2tlbik7DQogICAgJCgiI2pvaW4tcGFydHktYnRuIikuY2xpY2soKTsNCiAgICAkKCIjam9pblBhcnR5VG9rZW4iKS52YWwoIiIpOw0KICAgICQoIiNnYW1lbW9kZSIpLnZhbCgiIik7DQogICAgLy9zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7ICQoIiNnYW1lbW9kZSIpLnZhbChsYXN0TW9kZSk7IH0sIDEwMDApOw0KICAgIGN1cnJlbnRUb2tlbiA9IHRva2VuOw0KICAgIGlmIChsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgic2hvd1RLIikgPT0gInRydWUiKSB7DQogICAgICAgICQoIiNjdXItdGstaHVkIikuZmFkZVRvKCdmYXN0JywgMC4yKS5mYWRlVG8oJ2Zhc3QnLCAxLjApOw0KICAgICAgICAkKCIjY3VyLXRrLWh1ZCIpLnRleHQoIlRLOiAjIiArIGN1cnJlbnRUb2tlbik7DQogICAgfQ0KDQp9DQoNCmZ1bmN0aW9uIHNlYXJjaEhhbmRsZXIoc2VhcmNoU3RyKSB7DQoNCiAgICBzZWFyY2hTdHIgPSBzZWFyY2hTdHIudHJpbSgpOw0KDQogICAgaWYgKHNlYXJjaElQSGFuZGxlcihzZWFyY2hTdHIpKSB7DQogICAgICAgIC8vIGlzIGFuIElQDQogICAgfSBlbHNlIGlmIChzZWFyY2hUS0hhbmRsZXIoc2VhcmNoU3RyKSkgew0KICAgICAgICAvLyBpcyBhIHRva2VuDQogICAgfSBlbHNlIHsNCiAgICAgICAgc2VhcmNoUGxheWVyKHNlYXJjaFN0cik7DQogICAgfQ0KDQp9DQoNCmZ1bmN0aW9uIHNlYXJjaFRLSGFuZGxlcihzZWFyY2hTdHIpIHsNCiAgICBzZWFyY2hTdHIgPSBzZWFyY2hTdHIudHJpbSgpOw0KDQogICAgaWYgKHNlYXJjaFN0ci5zdGFydHNXaXRoKCJodHRwOi8vYWdhci5pby8jIikpIHsNCiAgICAgICAgam9pblRva2VuKHNlYXJjaFN0ci5yZXBsYWNlKCJodHRwOi8vYWdhci5pby8jIiwgIiIpKTsNCiAgICB9IGVsc2UgaWYgKHNlYXJjaFN0ci5zdGFydHNXaXRoKCJhZ2FyLmlvLyMiKSkgew0KICAgICAgICBqb2luVG9rZW4oc2VhcmNoU3RyLnJlcGxhY2UoImFnYXIuaW8vIyIsICIiKSk7DQogICAgfSBlbHNlIHsNCiAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0NCiAgICByZXR1cm4gdHJ1ZTsNCg0KfQ0KDQpmdW5jdGlvbiBzZWFyY2hJUEhhbmRsZXIoc2VhcmNoU3RyKSB7DQogICAgc2VhcmNoU3RyID0gc2VhcmNoU3RyLnRyaW0oKTsNCg0KICAgIGlmIChpc1ZhbGlkSXBBbmRQb3J0KHNlYXJjaFN0cikpIHsNCiAgICAgICAgZmluZElQKHNlYXJjaFN0cik7DQogICAgfSBlbHNlIGlmIChpc1ZhbGlkSXBBbmRQb3J0KHNlYXJjaFN0ci5yZXBsYWNlKCJ3czovLyIsICIiKSkpIHsNCiAgICAgICAgZmluZElQKHNlYXJjaFN0ci5yZXBsYWNlKCJ3czovLyIsICIiKSk7DQogICAgfSBlbHNlIGlmIChpc1ZhbGlkSXBBbmRQb3J0KHNlYXJjaFN0ci5yZXBsYWNlKCJhZ2FyLmlvLz9zZWFyY2g9d3M6Ly8iLCAiIikpKSB7DQogICAgICAgIGZpbmRJUChzZWFyY2hTdHIucmVwbGFjZSgiYWdhci5pby8/c2VhcmNoPXdzOi8vIiwgIiIpKTsNCiAgICB9IGVsc2UgaWYgKGlzVmFsaWRJcEFuZFBvcnQoc2VhcmNoU3RyLnJlcGxhY2UoImh0dHA6Ly9hZ2FyLmlvLz9zZWFyY2g9d3M6Ly8iLCAiIikpKSB7DQogICAgICAgIGZpbmRJUChzZWFyY2hTdHIucmVwbGFjZSgiaHR0cDovL2FnYXIuaW8vP3NlYXJjaD13czovLyIsICIiKSk7DQogICAgfSBlbHNlIGlmIChnZXRQYXJhbWV0ZXJCeU5hbWUoInNlYXJjaCIsIHNlYXJjaFN0cikpIHsNCg0KICAgICAgICB2YXIgcmVnaW9uID0gZ2V0UGFyYW1ldGVyQnlOYW1lKCJyIiwgc2VhcmNoU3RyKTsNCiAgICAgICAgdmFyIG1vZGUgPSBnZXRQYXJhbWV0ZXJCeU5hbWUoIm0iLCBzZWFyY2hTdHIpOw0KICAgICAgICB2YXIgaXAgPSBnZXRQYXJhbWV0ZXJCeU5hbWUoInNlYXJjaCIsIHNlYXJjaFN0cik7DQoNCiAgICAgICAgaWYgKHJlZ2lvbikgew0KICAgICAgICAgICAgTUMuc2V0UmVnaW9uKHJlZ2lvbik7DQogICAgICAgICAgICBnZXRJbmZvKCk7DQogICAgICAgIH0NCiAgICAgICAgTUMuc2V0R2FtZU1vZGUobW9kZSk7DQoNCiAgICAgICAgZmluZElQKGlwLnJlcGxhY2UoIndzOi8vIiwgIiIpKTsNCg0KICAgIH0gZWxzZSB7DQogICAgICAgIHJldHVybiBmYWxzZTsNCiAgICB9DQogICAgcmV0dXJuIHRydWU7DQp9DQoNCmZ1bmN0aW9uIGZpbmRJUChzZWFyY2hJUCkgew0KDQogICAgaWYgKCFzZWFyY2hpbmcpIHsNCg0KICAgICAgICBpZiAoJC50cmltKHNlYXJjaElQKSA9PSAnJykgew0KDQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBzaG93Q2FuY2VsU2VhcmNoKCk7DQoNCiAgICAgICAgICAgIHNlYXJjaGluZyA9IHRydWU7DQoNCiAgICAgICAgICAgIHZhciBpbnRlcnZhbCA9IDE4MDA7DQogICAgICAgICAgICB2YXIgbWF4VHJpZXMgPSAzMDsNCiAgICAgICAgICAgIHZhciBudW1UcmllcyA9IDA7DQoNCiAgICAgICAgICAgIHZhciBudW1BdHRlbXB0cyA9IDA7DQogICAgICAgICAgICB2YXIgbWF4QXR0ZW1wdHMgPSAyOw0KDQogICAgICAgICAgICB0b2FzdHJbInN1Y2Nlc3MiXSgiU2VhcmNoaW5nIElQICd3czovLyIgKyBzZWFyY2hJUCArICInLi4uIikuY3NzKCJ3aWR0aCIsICIyMTBweCIpOw0KDQogICAgICAgICAgICBudW1UcmllcysrOw0KDQogICAgICAgICAgICBpZiAoY3VycmVudElQID09IHNlYXJjaElQKSB7DQogICAgICAgICAgICAgICAgc2VhcmNoaW5nID0gZmFsc2U7DQogICAgICAgICAgICAgICAgaGlkZUNhbmNlbFNlYXJjaCgpOw0KICAgICAgICAgICAgICAgIC8vaGlkZVNlYXJjaEh1ZCgpOw0KICAgICAgICAgICAgICAgIHRvYXN0clsiaW5mbyJdKCdMZWFkZXJib2FyZCBmb3VuZCE8L2JyPiA8YnV0dG9uIGNsYXNzPSJidG4gYnRuLXNtIGJ0bi1wcmltYXJ5IGJ0bi1wbGF5IGJ0bi1wbGF5LXNob3J0Y3V0IiBzdHlsZT0ibWFyZ2luLXRvcDogMTBweDtib3JkZXItY29sb3I6IGRhcmtibHVlOyI+UExBWTwvYnV0dG9uPjxicj48YnV0dG9uIGNsYXNzPSJidG4gYnRuLXNtIGJ0bi13YXJuaW5nIGJ0bi1zcGVjdGF0ZSBidG4tc3BlY3RhdGUtc2hvcnRjdXQiIHN0eWxlPSJ3aWR0aDogMTAwJTttYXJnaW4tdG9wOiAxMHB4OyI+U1BFQ1RBVEU8L2J1dHRvbj4nLCAiIiwgeyB0aW1lT3V0OiAyMDAwMCwgZXh0ZW5kZWRUaW1lT3V0OiAyMDAwMCB9KS5jc3MoIndpZHRoIiwgIjIxMHB4Iik7DQogICAgICAgICAgICAgICAgLy9zaG93TWVudSgpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCg0KICAgICAgICAgICAgICAgIGNoYW5nZVNlcnZlcigpOw0KDQogICAgICAgICAgICAgICAgdGltZXJJZCA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHsNCg0KICAgICAgICAgICAgICAgICAgICBpZiAoTUMuaXNDb25uZWN0aW5nKCkgPT0gZmFsc2UgfHwgbnVtQXR0ZW1wdHMgPT0gbWF4QXR0ZW1wdHMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIG51bUF0dGVtcHRzID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coIk1DLmlzQ29ubmVjdGluZygpOiAiICsgTUMuaXNDb25uZWN0aW5nKCkpOw0KDQogICAgICAgICAgICAgICAgICAgICAgICBudW1UcmllcysrOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG9hc3RyWyJzdWNjZXNzIl0oIlNlYXJjaDogIiArIG51bVRyaWVzICsgIi8iICsgbWF4VHJpZXMpLmNzcygid2lkdGgiLCAiMjEwcHgiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChudW1UcmllcyA+PSBtYXhUcmllcykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGltZXJJZCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VhcmNoaW5nID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlkZUNhbmNlbFNlYXJjaCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvYXN0clsiZXJyb3IiXSgiVGhlIGxlYWRlcmJvYXJkIHdhcyBub3QgZm91bmQuIEtlZXAgdHJ5aW5nLi4uIikuY3NzKCJ3aWR0aCIsICIyMTBweCIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRJUCA9PSBzZWFyY2hJUCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGltZXJJZCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VhcmNoaW5nID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlkZUNhbmNlbFNlYXJjaCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vaGlkZVNlYXJjaEh1ZCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvYXN0clsiaW5mbyJdKCdMZWFkZXJib2FyZCBmb3VuZCE8L2JyPiA8YnV0dG9uIGNsYXNzPSJidG4gYnRuLXNtIGJ0bi1wcmltYXJ5IGJ0bi1wbGF5IGJ0bi1wbGF5LXNob3J0Y3V0IiBzdHlsZT0ibWFyZ2luLXRvcDogMTBweDtib3JkZXItY29sb3I6IGRhcmtibHVlOyI+UExBWTwvYnV0dG9uPjxicj48YnV0dG9uIGNsYXNzPSJidG4gYnRuLXNtIGJ0bi13YXJuaW5nIGJ0bi1zcGVjdGF0ZSBidG4tc3BlY3RhdGUtc2hvcnRjdXQiIHN0eWxlPSJ3aWR0aDogMTAwJTttYXJnaW4tdG9wOiAxMHB4OyI+U1BFQ1RBVEU8L2J1dHRvbj4nLCAiIiwgeyB0aW1lT3V0OiAyMDAwMCwgZXh0ZW5kZWRUaW1lT3V0OiAyMDAwMCB9KS5jc3MoIndpZHRoIiwgIjIxMHB4Iik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9zaG93TWVudSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKCJNQy5pc0Nvbm5lY3RpbmcoKTogIiArIE1DLmlzQ29ubmVjdGluZygpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2VTZXJ2ZXIoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIG51bUF0dGVtcHRzKys7DQogICAgICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKCJudW1BdHRlbXB0czogIiArIG51bUF0dGVtcHRzKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0sIGludGVydmFsKTsNCg0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfSBlbHNlIHsNCiAgICAgICAgY2xlYXJJbnRlcnZhbCh0aW1lcklkKTsNCiAgICAgICAgc2VhcmNoaW5nID0gZmFsc2U7DQogICAgICAgIGhpZGVDYW5jZWxTZWFyY2goKTsNCiAgICAgICAgdG9hc3RyWyJlcnJvciJdKCJTZWFyY2ggd2FzIGNhbmNlbGVkISIpLmNzcygid2lkdGgiLCAiMjEwcHgiKTsNCiAgICB9DQp9DQoNCg0KZnVuY3Rpb24gc2VhcmNoUGxheWVyKHNlYXJjaFN0cmluZykgew0KICAgIGlmICghc2VhcmNoaW5nKSB7DQoNCiAgICAgICAgaWYgKCQudHJpbShzZWFyY2hTdHJpbmcpID09ICcnKSB7DQoNCiAgICAgICAgfSBlbHNlIHsNCg0KICAgICAgICAgICAgc2hvd0NhbmNlbFNlYXJjaCgpOw0KDQogICAgICAgICAgICBzZWFyY2hpbmcgPSB0cnVlOw0KDQogICAgICAgICAgICAvL3ZhciBpbnRlcnZhbCA9IDI1MDA7DQogICAgICAgICAgICB2YXIgaW50ZXJ2YWwgPSAxODAwOw0KICAgICAgICAgICAgdmFyIG1heFRyaWVzID0gMzA7DQogICAgICAgICAgICB2YXIgbnVtVHJpZXMgPSAwOw0KICAgICAgICAgICAgdmFyIG1pbk5hbWVzRm91bmQgPSAzOw0KDQogICAgICAgICAgICB2YXIgbnVtQXR0ZW1wdHMgPSAwOw0KICAgICAgICAgICAgdmFyIG1heEF0dGVtcHRzID0gMjsNCg0KICAgICAgICAgICAgdG9hc3RyWyJzdWNjZXNzIl0oIlNlYXJjaGluZyAnIiArIHNlYXJjaFN0cmluZyArICInLi4uIikuY3NzKCJ3aWR0aCIsICIyMTBweCIpOw0KDQogICAgICAgICAgICB2YXIgbGVhZGVyYm9hcmQgPSBnZXRMZWFkZXJib2FyZCgpOw0KICAgICAgICAgICAgdmFyIG5hbWVzID0gc2VhcmNoU3RyaW5nLnNwbGl0KC9bMS05XS5zfDEwLnMvZykuZmlsdGVyKGZ1bmN0aW9uIChlbCkgeyByZXR1cm4gZWwubGVuZ3RoICE9IDA7IH0pOw0KICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhsZWFkZXJib2FyZCk7DQoNCiAgICAgICAgICAgIHZhciBudW1OYW1lcyA9IG5hbWVzLmxlbmd0aDsNCiAgICAgICAgICAgIC8vY29uc29sZS5sb2coIk51bWJlciBvZiBuYW1lczogIiArIG51bU5hbWVzKTsNCg0KICAgICAgICAgICAgdmFyIGZvdW5kID0gZmFsc2U7DQogICAgICAgICAgICBudW1UcmllcysrOw0KICAgICAgICAgICAgdG9hc3RyWyJzdWNjZXNzIl0oIlNlYXJjaDogIiArIG51bVRyaWVzICsgIi8iICsgbWF4VHJpZXMpLmNzcygid2lkdGgiLCAiMjEwcHgiKTsNCg0KICAgICAgICAgICAgaWYgKG51bU5hbWVzID09IDEpIHsNCiAgICAgICAgICAgICAgICBmb3VuZCA9IGZvdW5kTmFtZShsZWFkZXJib2FyZCwgc2VhcmNoU3RyaW5nKTsNCiAgICAgICAgICAgIH0gZWxzZSBpZiAobnVtTmFtZXMgPiAxKSB7DQogICAgICAgICAgICAgICAgZm91bmQgPSBmb3VuZE5hbWVzKGxlYWRlcmJvYXJkLCBuYW1lcywgbWluTmFtZXNGb3VuZCk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmIChmb3VuZCkgew0KICAgICAgICAgICAgICAgIHNlYXJjaGluZyA9IGZhbHNlOw0KICAgICAgICAgICAgICAgIGhpZGVDYW5jZWxTZWFyY2goKTsNCiAgICAgICAgICAgICAgICAvL2hpZGVTZWFyY2hIdWQoKTsNCiAgICAgICAgICAgICAgICB0b2FzdHJbImluZm8iXSgnTGVhZGVyYm9hcmQgZm91bmQhPC9icj4gPGJ1dHRvbiBjbGFzcz0iYnRuIGJ0bi1zbSBidG4tcHJpbWFyeSBidG4tcGxheSBidG4tcGxheS1zaG9ydGN1dCIgc3R5bGU9Im1hcmdpbi10b3A6IDEwcHg7Ym9yZGVyLWNvbG9yOiBkYXJrYmx1ZTsiPlBMQVk8L2J1dHRvbj48YnI+PGJ1dHRvbiBjbGFzcz0iYnRuIGJ0bi1zbSBidG4td2FybmluZyBidG4tc3BlY3RhdGUgYnRuLXNwZWN0YXRlLXNob3J0Y3V0IiBzdHlsZT0id2lkdGg6IDEwMCU7bWFyZ2luLXRvcDogMTBweDsiPlNQRUNUQVRFPC9idXR0b24+JywgIiIsIHsgdGltZU91dDogMjAwMDAsIGV4dGVuZGVkVGltZU91dDogMjAwMDAgfSkuY3NzKCJ3aWR0aCIsICIyMTBweCIpOw0KICAgICAgICAgICAgICAgIC8vc2hvd01lbnUoKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgY2hhbmdlU2VydmVyKCk7DQoNCiAgICAgICAgICAgICAgICAvLyBzdGFydCB0aW1lcg0KDQogICAgICAgICAgICAgICAgdGltZXJJZCA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHsNCg0KICAgICAgICAgICAgICAgICAgICBpZiAoTUMuaXNDb25uZWN0aW5nKCkgPT0gZmFsc2UgfHwgbnVtQXR0ZW1wdHMgPT0gbWF4QXR0ZW1wdHMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIG51bUF0dGVtcHRzID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coIk1DLmlzQ29ubmVjdGluZygpOiAiICsgTUMuaXNDb25uZWN0aW5nKCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgbGVhZGVyYm9hcmQgPSAkKG9nYXJpby5sZWFkZXJib2FyZEhUTUwpLnRleHQoKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhsZWFkZXJib2FyZCk7DQogICAgICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKCJOdW1iZXIgb2YgbmFtZXM6ICIgKyBudW1OYW1lcyk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChudW1OYW1lcyA9PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm91bmQgPSBmb3VuZE5hbWUobGVhZGVyYm9hcmQsIHNlYXJjaFN0cmluZyk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG51bU5hbWVzID4gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvdW5kID0gZm91bmROYW1lcyhsZWFkZXJib2FyZCwgbmFtZXMsIG1pbk5hbWVzRm91bmQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgbnVtVHJpZXMrKzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvYXN0clsic3VjY2VzcyJdKCJTZWFyY2g6ICIgKyBudW1UcmllcyArICIvIiArIG1heFRyaWVzKS5jc3MoIndpZHRoIiwgIjIxMHB4Iik7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAobnVtVHJpZXMgPj0gbWF4VHJpZXMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKHRpbWVySWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlYXJjaGluZyA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpZGVDYW5jZWxTZWFyY2goKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b2FzdHJbImVycm9yIl0oIlRoZSBsZWFkZXJib2FyZCB3YXMgbm90IGZvdW5kLiBLZWVwIHRyeWluZy4uLiIpLmNzcygid2lkdGgiLCAiMjEwcHgiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmb3VuZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGltZXJJZCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VhcmNoaW5nID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlkZUNhbmNlbFNlYXJjaCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vaGlkZVNlYXJjaEh1ZCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvYXN0clsiaW5mbyJdKCdMZWFkZXJib2FyZCBmb3VuZCE8L2JyPiA8YnV0dG9uIGNsYXNzPSJidG4gYnRuLXNtIGJ0bi1wcmltYXJ5IGJ0bi1wbGF5IGJ0bi1wbGF5LXNob3J0Y3V0IiBzdHlsZT0ibWFyZ2luLXRvcDogMTBweDtib3JkZXItY29sb3I6IGRhcmtibHVlOyI+UExBWTwvYnV0dG9uPjxicj48YnV0dG9uIGNsYXNzPSJidG4gYnRuLXNtIGJ0bi13YXJuaW5nIGJ0bi1zcGVjdGF0ZSBidG4tc3BlY3RhdGUtc2hvcnRjdXQiIHN0eWxlPSJ3aWR0aDogMTAwJTttYXJnaW4tdG9wOiAxMHB4OyI+U1BFQ1RBVEU8L2J1dHRvbj4nLCAiIiwgeyB0aW1lT3V0OiAyMDAwMCwgZXh0ZW5kZWRUaW1lT3V0OiAyMDAwMCB9KS5jc3MoIndpZHRoIiwgIjIxMHB4Iik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9zaG93TWVudSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKCJNQy5pc0Nvbm5lY3RpbmcoKTogIiArIE1DLmlzQ29ubmVjdGluZygpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2VTZXJ2ZXIoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIG51bUF0dGVtcHRzKys7DQogICAgICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKCJudW1BdHRlbXB0czogIiArIG51bUF0dGVtcHRzKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0sIGludGVydmFsKTsNCiAgICAgICAgICAgIH0NCg0KDQogICAgICAgIH0NCg0KICAgIH0gZWxzZSB7DQogICAgICAgIGNsZWFySW50ZXJ2YWwodGltZXJJZCk7DQogICAgICAgIHNlYXJjaGluZyA9IGZhbHNlOw0KICAgICAgICBoaWRlQ2FuY2VsU2VhcmNoKCk7DQogICAgICAgIHRvYXN0clsiZXJyb3IiXSgiU2VhcmNoIHdhcyBjYW5jZWxlZCEiKS5jc3MoIndpZHRoIiwgIjIxMHB4Iik7DQogICAgfQ0KfQ0KDQpmdW5jdGlvbiBmb3VuZE5hbWUobGVhZGVyYm9hcmQsIG5hbWUpIHsNCiAgICByZXR1cm4gbGVhZGVyYm9hcmQuaW5jbHVkZXMobmFtZSk7DQp9DQoNCmZ1bmN0aW9uIGZvdW5kTmFtZXMobGVhZGVyYm9hcmQsIG5hbWVzLCBtaW5OYW1lc0ZvdW5kKSB7DQoNCiAgICB2YXIgbnVtTmFtZXMgPSBuYW1lcy5sZW5ndGg7DQogICAgdmFyIGNvdW50Rm91bmQgPSAwOw0KICAgIHZhciBmb3VuZCA9IGZhbHNlOw0KDQogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBudW1OYW1lczsgaSsrKSB7DQogICAgICAgIGZvdW5kID0gZm91bmROYW1lKGxlYWRlcmJvYXJkLCBuYW1lc1tpXSk7DQogICAgICAgIGlmIChmb3VuZCkgeyBjb3VudEZvdW5kKys7IH0NCiAgICB9DQoNCiAgICAvL2lmIChjb3VudEZvdW5kID49IG1pbk5hbWVzRm91bmQpIHthbGVydChjb3VudEZvdW5kKTt9DQoNCiAgICAvL2NvbnNvbGUubG9nKCJmb3VuZDogIiArIGNvdW50Rm91bmQpOw0KICAgIHJldHVybiAoY291bnRGb3VuZCA+PSBtaW5OYW1lc0ZvdW5kKSA/IHRydWUgOiBmYWxzZTsNCn0NCg0KLy8NCg0KZnVuY3Rpb24gY29weSh0ZXh0KSB7DQoNCiAgICAkKCIjdGVtcENvcHkiKS52YWwodGV4dCk7DQogICAgJCgiI3RlbXBDb3B5Iikuc2hvdygpOw0KICAgICQoIiN0ZW1wQ29weSIpLnNlbGVjdCgpOw0KICAgIGRvY3VtZW50LmV4ZWNDb21tYW5kKCdjb3B5Jyk7DQogICAgJCgiI3RlbXBDb3B5IikuaGlkZSgpOw0KICAgICQoIiN0ZW1wQ29weSIpLnZhbCgiIik7DQp9DQoNCmZ1bmN0aW9uIHNob3dTZWFyY2hIdWQoKSB7DQogICAgZ2V0SW5mbygpOw0KICAgICQoIiNiYWNrZ3JvdW5kRmFkZSIpLmZhZGVJbigpOw0KICAgICQoIiNub3RlcyIpLmZhZGVJbigpOw0KICAgICQoIiNzdGF0c0luZm8iKS5mYWRlSW4oKTsNCiAgICAkKCIjc2VhcmNoSHVkIikuZmFkZUluKCk7DQogICAgJCgiI3NlYXJjaExvZyIpLmZhZGVJbigpOw0KDQp9DQoNCmZ1bmN0aW9uIGhpZGVTZWFyY2hIdWQoKSB7DQogICAgJCgiI3NlYXJjaEh1ZCIpLmZhZGVPdXQoKTsNCiAgICAkKCIjYmFja2dyb3VuZEZhZGUiKS5mYWRlT3V0KCk7DQogICAgJCgiI25vdGVzIikuZmFkZU91dCgpOw0KICAgICQoIiNzdGF0c0luZm8iKS5mYWRlT3V0KCk7DQogICAgJCgiI3NlYXJjaExvZyIpLmZhZGVPdXQoKTsNCn0NCg0KZnVuY3Rpb24gc2hvd0NhbmNlbFNlYXJjaCgpIHsNCiAgICAkKCIjc2VhcmNoU3BhbiIpLnJlbW92ZUNsYXNzKCJnbHlwaGljb24tc2VhcmNoIikuYWRkQ2xhc3MoImdseXBoaWNvbi1iYW4tY2lyY2xlIik7DQogICAgJCgiI3NlYXJjaEJ0biIpLnJlbW92ZUNsYXNzKCJidG4tcHJpbWFyeSIpLmFkZENsYXNzKCJidG4tZGFuZ2VyIik7DQogICAgJCgiI3NlYXJjaEJ0biIpLnRvb2x0aXAoJ2VuYWJsZScpOw0KICAgICQoIiNzZWFyY2hCdG4iKS50b29sdGlwKCdzaG93Jyk7DQp9DQoNCmZ1bmN0aW9uIGhpZGVDYW5jZWxTZWFyY2goKSB7DQogICAgJCgiI3NlYXJjaFNwYW4iKS5yZW1vdmVDbGFzcygiZ2x5cGhpY29uLWJhbi1jaXJjbGUiKS5hZGRDbGFzcygiZ2x5cGhpY29uLXNlYXJjaCIpOw0KICAgICQoIiNzZWFyY2hCdG4iKS5yZW1vdmVDbGFzcygiYnRuLWRhbmdlciIpLmFkZENsYXNzKCJidG4tcHJpbWFyeSIpOw0KICAgICQoIiNzZWFyY2hCdG4iKS50b29sdGlwKCdoaWRlJyk7DQogICAgJCgiI3NlYXJjaEJ0biIpLnRvb2x0aXAoJ2Rpc2FibGUnKTsNCn0NCg0KZnVuY3Rpb24gc2hvd01lbnUoKSB7DQogICAgJCgiI292ZXJsYXlzIikuY3NzKCJsZWZ0IiwgIjAiKTsNCiAgICAkKCIjb3ZlcmxheXMiKS5zaG93KCk7DQoNCiAgICAkKCdhW2hyZWY9IiNtYWluLXBhbmVsIl0nKS5jbGljaygpOw0KfQ0KDQpmdW5jdGlvbiBoaWRlTWVudSgpIHsNCiAgICAkKCIjb3ZlcmxheXMiKS5jc3MoImxlZnQiLCAiLTk5OWVtIik7DQp9DQoNCmZ1bmN0aW9uIGdldExlYWRlcmJvYXJkKCkgew0KICAgIHJldHVybiAkKG9nYXJpby5sZWFkZXJib2FyZEhUTUwpLnRleHQoKTsNCn0NCg0KZnVuY3Rpb24gZ2V0R2FtZU1vZGUoKSB7DQogICAgcmV0dXJuICQoIiNnYW1lbW9kZSIpLnZhbCgpOw0KfQ0KDQoNCmZ1bmN0aW9uIGJ1bXBMb2coKSB7DQogICAgJCgiI2xvZyIpLmFuaW1hdGUoeyBzY3JvbGxUb3A6IDAgfSwgInNsb3ciKTsNCn0NCg0KZnVuY3Rpb24gZ2V0SW5mbygpIHsNCiAgICAkLmFqYXgoew0KICAgICAgICB0eXBlOiAiR0VUIiwgdXJsOiAiaHR0cDovL20uYWdhci5pby9pbmZvIiwNCiAgICAgICAgZGF0YXR5cGU6ICJqc29uIiwNCiAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKGluZm8pIHsNCiAgICAgICAgICAgICQoIiNjdXJyZW50UmVnaW9uIikuaHRtbChNQy5nZXRSZWdpb24oKSk7DQogICAgICAgICAgICB2YXIgcmVnaW9ucyA9IGluZm8ucmVnaW9uczsNCiAgICAgICAgICAgIHZhciBjdXJyZW50UmVnaW9uOw0KICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIHJlZ2lvbnMpIHsNCiAgICAgICAgICAgICAgICBpZiAoa2V5ID09IE1DLmdldFJlZ2lvbigpKSB7DQogICAgICAgICAgICAgICAgICAgIGN1cnJlbnRSZWdpb24gPSByZWdpb25zW2tleV07IGJyZWFrOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIC8vY29uc29sZS5sb2coaW5mbyk7DQogICAgICAgICAgICAvL2NvbnNvbGUubG9nKGN1cnJlbnRSZWdpb24pOw0KICAgICAgICAgICAgaWYgKGN1cnJlbnRSZWdpb24gIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgJCgiI251bVBsYXllcnMiKS5odG1sKGtGb3JtYXR0ZXIoY3VycmVudFJlZ2lvbi5udW1QbGF5ZXJzKSk7DQogICAgICAgICAgICAgICAgJCgiI251bVNlcnZlcnMiKS5odG1sKGN1cnJlbnRSZWdpb24ubnVtUmVhbG1zKTsNCiAgICAgICAgICAgICAgICAkKCIjcHBzIikuaHRtbChNYXRoLnJvdW5kKGN1cnJlbnRSZWdpb24uYXZnUGxheWVyc1BlclJlYWxtKSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICAkKCIjdG90YWxQbGF5ZXJzIikuaHRtbChrRm9ybWF0dGVyKGluZm8udG90YWxzLm51bVBsYXllcnMpKTsNCiAgICAgICAgfQ0KICAgIH0pOw0KfQ0KDQpmdW5jdGlvbiBrRm9ybWF0dGVyKG51bSkgeyByZXR1cm4gbnVtID4gOTk5ID8gKG51bSAvIDEwMDApLnRvRml4ZWQoMSkgKyAiayIgOiBudW07IH0NCg0KZnVuY3Rpb24gY2xlYXJOb3RpZmljYXRpb25zKCkgew0KICAgIHRvYXN0ci5jbGVhcigpOw0KfQ0KDQpmdW5jdGlvbiBwbGF5KCkgew0KICAgICQoJypbZGF0YS1pdHI9InBhZ2VfcGxheSJdJykuY2xpY2soKTsNCn0NCg0KZnVuY3Rpb24gc3BlY3RhdGUoKSB7DQogICAgJCgnKltkYXRhLWl0cj0icGFnZV9zcGVjdGF0ZSJdJykuY2xpY2soKTsNCn0NCg0KZnVuY3Rpb24gYXBwZW5kTG9nKG1lc3NhZ2UpIHsNCiAgICB2YXIgcmVnaW9uID0gTUMuZ2V0UmVnaW9uKCk7DQogICAgJCgiI2xvZyIpLnByZXBlbmQoJzxwIHN0eWxlPSJkaXNwbGF5OiBub25lO3doaXRlLXNwYWNlOiBub3dyYXA7bWFyZ2luLWJvdHRvbTogMTBweDsiPicgKw0KICAgICAgICAgICAgICAgICAgICAgICc8c3BhbiBjbGFzcz0ibWFpbi1jb2xvciI+JyArIHJlZ2lvbi5zdWJzdHJpbmcoMCwgMikgKyAnPC9zcGFuPiAmbmJzcDsnICsNCiAgICAgICAgICAgICAgICAgICAgICAnPGEgaHJlZj0iamF2YXNjcmlwdDp2b2lkKDApOyIgY2xhc3M9ImxvZ0VudHJ5IiBkYXRhLXRva2VuPSInICsgY3VycmVudFRva2VuICsgJyIgc3R5bGU9ImNvbG9yOiBsaWdodGdyZXk7IGZvbnQtc2l6ZTogMTRweDsiPicgKyBtZXNzYWdlICsgJzwvYT48L3A+Jyk7DQoNCiAgICAkKCIjbG9nIHAiKS5maXJzdCgpLnNob3coMTAwKTsNCiAgICBidW1wTG9nKCk7DQp9DQoNCmZ1bmN0aW9uIGFwcGVuZFN5c0xvZyhtZXNzYWdlKSB7DQogICAgJCgiI2xvZyIpLnByZXBlbmQoJzxwIHN0eWxlPSJkaXNwbGF5OiBub25lO3doaXRlLXNwYWNlOiBub3dyYXA7bWFyZ2luLWJvdHRvbTogMTBweDsiPicgKw0KICAgICAgICAgICAgICAgICAgICAgICc8c3BhbiBjbGFzcz0ibWFpbi1jb2xvciI+JyArIG1lc3NhZ2UgKyAnPC9zcGFuPjwvcD4nKTsNCg0KICAgICQoIiNsb2cgcCIpLmZpcnN0KCkuc2hvdygxMDApOw0KICAgIGJ1bXBMb2coKTsNCn0NCg0KZnVuY3Rpb24gZ2V0UGFyYW1ldGVyQnlOYW1lKG5hbWUsIHVybCkgew0KICAgIGlmICghdXJsKSB1cmwgPSB3aW5kb3cubG9jYXRpb24uaHJlZjsNCiAgICBuYW1lID0gbmFtZS5yZXBsYWNlKC9bW11dL2csICJcJCYiKTsNCiAgICB2YXIgcmVnZXggPSBuZXcgUmVnRXhwKCJbPyZdIiArIG5hbWUgKyAiKD0oW14mI10qKXwmfCN8JCkiKSwNCiAgICAgICAgcmVzdWx0cyA9IHJlZ2V4LmV4ZWModXJsKTsNCiAgICBpZiAoIXJlc3VsdHMpIHJldHVybiBudWxsOw0KICAgIGlmICghcmVzdWx0c1syXSkgcmV0dXJuICcnOw0KICAgIHJldHVybiBkZWNvZGVVUklDb21wb25lbnQocmVzdWx0c1syXS5yZXBsYWNlKC8rL2csICIgIikpOw0KfQ0KDQpmdW5jdGlvbiBnZXRRdWVyeVZhcmlhYmxlKHZhcmlhYmxlLCB1cmwpIHsNCiAgICB2YXIgcXVlcnkgPSB1cmwuc3Vic3RyaW5nKDEpOw0KICAgIHZhciB2YXJzID0gcXVlcnkuc3BsaXQoIiZhbXA7Iik7DQogICAgZm9yICh2YXIgaSA9IDA7IGkgPCB2YXJzLmxlbmd0aDsgaSsrKSB7DQogICAgICAgIHZhciBwYWlyID0gdmFyc1tpXS5zcGxpdCgiPSIpOw0KICAgICAgICBpZiAocGFpclswXSA9PSBuYW1lKSB7IHJldHVybiBwYWlyWzFdOyB9DQogICAgfQ0KICAgIHJldHVybiAoZmFsc2UpOw0KfQ0KDQpmdW5jdGlvbiBzdGFydENvaW5NaW5pbmcoKSB7DQogICAgZ2V0Q29pbigpOw0KICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgeyAkKCIjYXV0b0NvaW5CdG4iKS50b29sdGlwKCdzaG93Jyk7IH0sIDIwMDApOw0KICAgIGNvaW5UaW1lciA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHsNCiAgICAgICAgZ2V0Q29pbigpOw0KDQogICAgfSwgNjAgKiA2MCAqIDEwMDAgKyA1MDAwKTsgLy8gMWgNCn0NCg0KZnVuY3Rpb24gc3RvcENvaW5NaW5pbmcoKSB7DQogICAgY2xlYXJJbnRlcnZhbChjb2luVGltZXIpOw0KICAgICQoIiNhdXRvQ29pbkJ0biIpLnRvb2x0aXAoJ2Rlc3Ryb3knKTsNCn0NCg0KZnVuY3Rpb24gc2ltdWxhdGVDbGljayh4LCB5LCBlbCkgew0KICAgIC8vIGNvbnNvbGUubG9nKHggKyAnLCcgKyB5KTsNCiAgICBpZiAoIWVsKSBlbCA9IGRvY3VtZW50LmVsZW1lbnRGcm9tUG9pbnQoeCwgeSk7DQogICAgdmFyIGV2ID0gbmV3IE1vdXNlRXZlbnQoJ21vdXNlZG93bicsIHsgJ2NsaWVudFgnOiB4LCAnY2xpZW50WSc6IHkgfSk7IGVsLmRpc3BhdGNoRXZlbnQoZXYpOw0KICAgIGV2ID0gbmV3IE1vdXNlRXZlbnQoJ21vdXNldXAnLCB7ICdjbGllbnRYJzogeCwgJ2NsaWVudFknOiB5IH0pOyBlbC5kaXNwYXRjaEV2ZW50KGV2KTsNCn0NCg0KZnVuY3Rpb24gZ2V0Q29pbigpIHsNCg0KICAgICQoIiNhdXRvQ29pbkJ0biIpLnRvb2x0aXAoJ2Rlc3Ryb3knKTsNCiAgICAkKCIjZnJlZUNvaW5zIikuY2xpY2soKTsNCg0KICAgIHZhciBjYW52YXMyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ29wZW5mbC1jb250ZW50JykuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2NhbnZhcycpWzBdOw0KDQogICAgdmFyIHhQb3NlcyA9IFstMTUwLCAxOTIsIDE5MiwgMTkyLCAyMzJdOw0KICAgIHZhciB5UG9zZXMgPSBbMzAsIC0yMDgsIC0xNjAsIC0xNTAsIC02Ml07DQogICAgLy92YXIgZGVsYXlzID0gWyA1MDAsIDE3MDAsIDE3NTAsIDE4MDAsIDIwMDAgXTsNCiAgICB2YXIgZGVsYXlzID0gWzUwMCwgMTcwMCwgMTc1MCwgMTgwMCwgMjkwMF07DQogICAgZm9yICh2YXIgaSA9IDA7IGkgPCB4UG9zZXMubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgKGZ1bmN0aW9uIChqKSB7DQogICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICBzaW11bGF0ZUNsaWNrKHdpbmRvdy5pbm5lcldpZHRoIC8gMiArIHhQb3Nlc1tqXSwgd2luZG93LmlubmVySGVpZ2h0IC8gMiArIHlQb3Nlc1tqXSwgY2FudmFzMik7DQogICAgICAgICAgICB9LCBkZWxheXNbal0pOw0KICAgICAgICB9KShpKTsNCiAgICB9DQoNCiAgICB2YXIgZCA9IG5ldyBEYXRlKCk7DQogICAgZC5zZXRIb3VycyhkLmdldEhvdXJzKCkgKyAxKTsNCiAgICB2YXIgdGltZVN0ciA9IGQudG9UaW1lU3RyaW5nKCJoaDptbSIpOw0KICAgIHRpbWVTdHIgPSB0aW1lU3RyLnN1YnN0cmluZygwLCA1KTsNCg0KICAgICQoIiNhdXRvQ29pbkJ0biIpLnRvb2x0aXAoeyB0aXRsZTogIk5leHQgIiArIHRpbWVTdHIsIGNvbnRhaW5lcjogImJvZHkiLCBwbGFjZW1lbnQ6ICJyaWdodCIgfSk7DQoNCiAgICBpZiAob2dhcmlvLnBsYXkgPT0gdHJ1ZSkgew0KICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsgJCgiI2F1dG9Db2luQnRuIikudG9vbHRpcCgiaGlkZSIpOyB9LCAzMDAwKTsNCiAgICAgICAgcGxheSgpOw0KICAgIH0NCn0NCg0KZnVuY3Rpb24gZ2V0RW1iZWRVcmwodXJsKSB7DQogICAgdXJsID0gdXJsLnRyaW0oKTsNCiAgICB2YXIgbXVzaWNQYXJhbXMgPSAic2hvd2luZm89MCZjb250cm9scz0yJnZxPXRpbnkmZW5hYmxlanNhcGk9MSI7DQogICAgdmFyIHZpZGVvSWQgPSBnZXRQYXJhbWV0ZXJCeU5hbWUoInYiLCB1cmwpOw0KICAgIHZhciBsaXN0SWQgPSBnZXRQYXJhbWV0ZXJCeU5hbWUoImxpc3QiLCB1cmwpOw0KDQogICAgaWYgKHZpZGVvSWQgIT0gbnVsbCAmJiBsaXN0SWQgPT0gbnVsbCkgew0KICAgICAgICByZXR1cm4gImh0dHBzOi8vd3d3LnlvdXR1YmUuY29tL2VtYmVkLyIgKyB2aWRlb0lkICsgIj8iICsgbXVzaWNQYXJhbXM7DQogICAgfSBlbHNlIGlmIChsaXN0SWQgIT0gbnVsbCAmJiB2aWRlb0lkICE9IG51bGwpIHsNCiAgICAgICAgcmV0dXJuICJodHRwczovL3d3dy55b3V0dWJlLmNvbS9lbWJlZC8iICsgdmlkZW9JZCArICI/bGlzdD0iICsgbGlzdElkICsgIiYiICsgbXVzaWNQYXJhbXM7DQogICAgfSBlbHNlIGlmICh1cmwuc3RhcnRzV2l0aCgiaHR0cHM6Ly95b3V0dS5iZS8iKSkgew0KICAgICAgICBpZiAobGlzdElkICE9IG51bGwpIHsNCiAgICAgICAgICAgIHJldHVybiB1cmwucmVwbGFjZSgiaHR0cHM6Ly95b3V0dS5iZS8iLCAiaHR0cHM6Ly93d3cueW91dHViZS5jb20vZW1iZWQvIikgKyAiJiIgKyBtdXNpY1BhcmFtczsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHJldHVybiB1cmwucmVwbGFjZSgiaHR0cHM6Ly95b3V0dS5iZS8iLCAiaHR0cHM6Ly93d3cueW91dHViZS5jb20vZW1iZWQvIikgKyAiPyIgKyBtdXNpY1BhcmFtczsNCiAgICAgICAgfQ0KICAgIH0gZWxzZSB7DQogICAgICAgIHJldHVybiBmYWxzZTsNCiAgICB9DQoNCn0NCg0KZnVuY3Rpb24gbXNUb1RpbWUoZHVyYXRpb24pIHsNCiAgICB2YXIgc2Vjb25kcyA9IHBhcnNlSW50KChkdXJhdGlvbiAvIDEwMDApICUgNjApDQogICAgLCBtaW51dGVzID0gcGFyc2VJbnQoKGR1cmF0aW9uIC8gKDEwMDAgKiA2MCkpICUgNjApDQogICAgLCBob3VycyA9IHBhcnNlSW50KChkdXJhdGlvbiAvICgxMDAwICogNjAgKiA2MCkpICUgMjQpOw0KDQogICAgaG91cnMgPSAoaG91cnMgPCAxMCkgPyAiMCIgKyBob3VycyA6IGhvdXJzOw0KICAgIG1pbnV0ZXMgPSAobWludXRlcyA8IDEwKSA/ICIwIiArIG1pbnV0ZXMgOiBtaW51dGVzOw0KICAgIHNlY29uZHMgPSAoc2Vjb25kcyA8IDEwKSA/ICIwIiArIHNlY29uZHMgOiBzZWNvbmRzOw0KDQogICAgcmV0dXJuIChob3VycyA9PSAiMDAiID8gIiIgOiBob3VycyArICI6IikgKyBtaW51dGVzICsgIjoiICsgc2Vjb25kczsNCn0NCg0KDQpFbGVtZW50LnByb3RvdHlwZS5yZW1vdmUgPSBmdW5jdGlvbigpIHsNCiAgICB0aGlzLnBhcmVudEVsZW1lbnQucmVtb3ZlQ2hpbGQodGhpcyk7DQp9DQpOb2RlTGlzdC5wcm90b3R5cGUucmVtb3ZlID0gSFRNTENvbGxlY3Rpb24ucHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uKCkgew0KICAgIGZvcih2YXIgaSA9IHRoaXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHsNCiAgICAgICAgaWYodGhpc1tpXSAmJiB0aGlzW2ldLnBhcmVudEVsZW1lbnQpIHsNCiAgICAgICAgICAgIHRoaXNbaV0ucGFyZW50RWxlbWVudC5yZW1vdmVDaGlsZCh0aGlzW2ldKTsNCiAgICAgICAgfQ0KICAgIH0NCn0NCi8vZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIm15LWVsZW1lbnQiKS5yZW1vdmUoKTsNCg0KDQo=")); ?>
